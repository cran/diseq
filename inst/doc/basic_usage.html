<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Some examples of use-cases using the market models of the package</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Some examples of use-cases using the market models of the package</h1>



<p>This short tutorial covers the very basic use cases to get you started with <em>diseq</em>. More usage details can be found in the documentation of the package.</p>
<div id="setup-the-environment" class="section level2">
<h2>Setup the environment</h2>
<p>Load the required libraries.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(diseq)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(Formula)</a></code></pre></div>
<p>Prepare the data. Normally this step is long and it depends on the nature of the data and the considered market. For this example, we will use simulated data. Although we could simulate data independently from the package, we will use the top-level simulation functionality of <em>diseq</em> to simplify the process. See the documentation of <code>simulate_data</code> for more information on the simulation functionality. Here, we simulate data using a data generating process for a market in disequilibrium with stochastic price dynamics.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">nobs &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb2-2" title="2">tobs &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4">alpha_d &lt;-<span class="st"> </span><span class="fl">-0.3</span></a>
<a class="sourceLine" id="cb2-5" title="5">beta_d0 &lt;-<span class="st"> </span><span class="fl">6.8</span></a>
<a class="sourceLine" id="cb2-6" title="6">beta_d &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">-0.02</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">eta_d &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">-0.1</span>)</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9">alpha_s &lt;-<span class="st"> </span><span class="fl">0.6</span></a>
<a class="sourceLine" id="cb2-10" title="10">beta_s0 &lt;-<span class="st"> </span><span class="fl">2.1</span></a>
<a class="sourceLine" id="cb2-11" title="11">beta_s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb2-12" title="12">eta_s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14">gamma &lt;-<span class="st"> </span><span class="fl">1.2</span></a>
<a class="sourceLine" id="cb2-15" title="15">beta_p0 &lt;-<span class="st"> </span><span class="fl">0.9</span></a>
<a class="sourceLine" id="cb2-16" title="16">beta_p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb2-17" title="17"></a>
<a class="sourceLine" id="cb2-18" title="18">sigma_d &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-19" title="19">sigma_s &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-20" title="20">sigma_p &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-21" title="21">rho_ds &lt;-<span class="st"> </span><span class="fl">0.0</span></a>
<a class="sourceLine" id="cb2-22" title="22">rho_dp &lt;-<span class="st"> </span><span class="fl">0.0</span></a>
<a class="sourceLine" id="cb2-23" title="23">rho_sp &lt;-<span class="st"> </span><span class="fl">0.0</span></a>
<a class="sourceLine" id="cb2-24" title="24"></a>
<a class="sourceLine" id="cb2-25" title="25">seed &lt;-<span class="st"> </span><span class="dv">443</span></a>
<a class="sourceLine" id="cb2-26" title="26"></a>
<a class="sourceLine" id="cb2-27" title="27">stochastic_adjustment_data &lt;-<span class="st"> </span><span class="kw">simulate_data</span>(</a>
<a class="sourceLine" id="cb2-28" title="28">  <span class="st">&quot;diseq_stochastic_adjustment&quot;</span>, nobs, tobs,</a>
<a class="sourceLine" id="cb2-29" title="29">  alpha_d, beta_d0, beta_d, eta_d,</a>
<a class="sourceLine" id="cb2-30" title="30">  alpha_s, beta_s0, beta_s, eta_s,</a>
<a class="sourceLine" id="cb2-31" title="31">  gamma, beta_p0, beta_p,</a>
<a class="sourceLine" id="cb2-32" title="32">  <span class="dt">sigma_d =</span> sigma_d, <span class="dt">sigma_s =</span> sigma_s, <span class="dt">sigma_p =</span> sigma_p,</a>
<a class="sourceLine" id="cb2-33" title="33">  <span class="dt">rho_ds =</span> rho_ds, <span class="dt">rho_dp =</span> rho_dp, <span class="dt">rho_sp =</span> rho_sp,</a>
<a class="sourceLine" id="cb2-34" title="34">  <span class="dt">seed =</span> seed</a>
<a class="sourceLine" id="cb2-35" title="35">)</a></code></pre></div>
</div>
<div id="estimate-the-models" class="section level2">
<h2>Estimate the models</h2>
<p>Prepare the basic parameters for model initialization. The <code>simulate_data</code> call uses <code>Q</code> for the simulated traded quantity, <code>P</code> for the simulated prices, <code>id</code> for subject identification, and <code>date</code> for time identification. It automatically creates the demand specific variables <code>Xd1</code> and <code>Xd2</code>, the supply specific variable <code>Xs1</code>, the common (i.e. both demand and supply) variables <code>X1</code> and <code>X2</code>, and the price dynamics’ variable <code>Xp1</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">market_spec &lt;-<span class="st">   </span>Q <span class="op">|</span><span class="st"> </span>P <span class="op">|</span><span class="st"> </span>id <span class="op">|</span><span class="st"> </span>date <span class="op">~</span><span class="st"> </span>P <span class="op">+</span><span class="st"> </span>Xd1 <span class="op">+</span><span class="st"> </span>Xd2 <span class="op">+</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2 <span class="op">|</span><span class="st"> </span>P <span class="op">+</span><span class="st"> </span>Xs1 <span class="op">+</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2</a></code></pre></div>
<p>The market specification has two be modified in two cases. For the <code>diseq_directional</code>, the price variable is removed from the supply equation because the separation rule of the model can only be used for markets with exclusively either inelastic demand or supply. For the <code>diseq_stochastic_adjustment</code>, the right hand side of the price dynamics equation is appended in the market specification.</p>
<p>By default the models are estimated by allowing the demand, supply, and price equations to have correlated error shocks. The default verbosity behavior is to display errors and warnings that might occur when estimating the models.</p>
<p>By default all models are estimated using full information maximum likelihood based on the <code>&quot;BFGS&quot;</code> optimization algorithm. The first <code>equilibrium_model</code> call modifies the estimation behavior and estimates the model using two stage least squares. The <code>diseq_basic</code> call modifies the default optimization behavior and estimates the model using the <code>&quot;Nelder-Mead&quot;</code> optimization methods.</p>
<p>Standard errors are by default assumed to be homoscedastic. The second <code>equilibrium_model</code> and <code>diseq_deterministic_adjustment</code> calls modify this behavior by calculating clustered standard errors based on the subject identifier, while the <code>diseq_basic</code> and <code>diseq_directional</code> calls modify it by calculating heteroscedastic standard errors via the sandwich estimator.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">eqmdl_reg &lt;-<span class="st"> </span><span class="kw">equilibrium_model</span>(</a>
<a class="sourceLine" id="cb4-2" title="2">  market_spec, stochastic_adjustment_data,</a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="dt">estimation_options =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;2SLS&quot;</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">)</a>
<a class="sourceLine" id="cb4-5" title="5">eqmdl_fit &lt;-<span class="st"> </span><span class="kw">equilibrium_model</span>(</a>
<a class="sourceLine" id="cb4-6" title="6">    market_spec, stochastic_adjustment_data,</a>
<a class="sourceLine" id="cb4-7" title="7">    <span class="dt">estimation_options =</span> <span class="kw">list</span>(<span class="dt">standard_errors =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>))</a>
<a class="sourceLine" id="cb4-8" title="8">)</a>
<a class="sourceLine" id="cb4-9" title="9">bsmdl_fit &lt;-<span class="st"> </span><span class="kw">diseq_basic</span>(</a>
<a class="sourceLine" id="cb4-10" title="10">    market_spec, stochastic_adjustment_data,</a>
<a class="sourceLine" id="cb4-11" title="11">    <span class="dt">estimation_options =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb4-12" title="12">        <span class="dt">method =</span> <span class="st">&quot;Nelder-Mead&quot;</span>, <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">maxit =</span> <span class="fl">1e+5</span>),</a>
<a class="sourceLine" id="cb4-13" title="13">        <span class="dt">standard_errors =</span> <span class="st">&quot;heteroscedastic&quot;</span></a>
<a class="sourceLine" id="cb4-14" title="14">    )</a>
<a class="sourceLine" id="cb4-15" title="15">)</a>
<a class="sourceLine" id="cb4-16" title="16">drmdl_fit &lt;-<span class="st"> </span><span class="kw">diseq_directional</span>(</a>
<a class="sourceLine" id="cb4-17" title="17">    <span class="kw">formula</span>(<span class="kw">update</span>(<span class="kw">Formula</span>(market_spec), . <span class="op">~</span><span class="st"> </span>. <span class="op">|</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>P)),</a>
<a class="sourceLine" id="cb4-18" title="18">    stochastic_adjustment_data,</a>
<a class="sourceLine" id="cb4-19" title="19">    <span class="dt">estimation_options =</span> <span class="kw">list</span>(<span class="dt">standard_errors =</span> <span class="st">&quot;heteroscedastic&quot;</span>)</a>
<a class="sourceLine" id="cb4-20" title="20">)</a>
<a class="sourceLine" id="cb4-21" title="21">damdl_fit &lt;-<span class="st"> </span><span class="kw">diseq_deterministic_adjustment</span>(</a>
<a class="sourceLine" id="cb4-22" title="22">    market_spec, stochastic_adjustment_data,</a>
<a class="sourceLine" id="cb4-23" title="23">    <span class="dt">estimation_options =</span> <span class="kw">list</span>(<span class="dt">standard_errors =</span> <span class="kw">c</span>(<span class="st">&quot;id&quot;</span>))</a>
<a class="sourceLine" id="cb4-24" title="24">)</a>
<a class="sourceLine" id="cb4-25" title="25">samdl_fit &lt;-<span class="st"> </span><span class="kw">diseq_stochastic_adjustment</span>(</a>
<a class="sourceLine" id="cb4-26" title="26">    <span class="kw">formula</span>(<span class="kw">update</span>(<span class="kw">Formula</span>(market_spec), . <span class="op">~</span><span class="st"> </span>. <span class="op">|</span><span class="st"> </span>. <span class="op">|</span><span class="st"> </span>Xp1)),</a>
<a class="sourceLine" id="cb4-27" title="27">    stochastic_adjustment_data,</a>
<a class="sourceLine" id="cb4-28" title="28">    <span class="dt">estimation_options =</span> <span class="kw">list</span>(<span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">maxit =</span> <span class="fl">1e+5</span>))</a>
<a class="sourceLine" id="cb4-29" title="29">)</a></code></pre></div>
</div>
<div id="post-estimation-analysis" class="section level2">
<h2>Post estimation analysis</h2>
<div id="marginal-effects" class="section level3">
<h3>Marginal effects</h3>
<p>Calculate marginal effects on the shortage probabilities. <em>Diseq</em> offers two marginal effect calls out of the box. The mean marginal effects and the marginal effects ate the mean. Marginal effects on the shortage probabilities are state-dependent. If the variable is only in the demand equation, the output name of the marginal effect is the variable name prefixed by <code>D_</code>. If the variable is only in the supply equation, the name of the marginal effect is the variable name prefixed by <code>S_</code>. If the variable is in both equations, then it is prefixed by <code>B_</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">variables &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;P&quot;</span>, <span class="st">&quot;Xd1&quot;</span>, <span class="st">&quot;Xd2&quot;</span>, <span class="st">&quot;X1&quot;</span>, <span class="st">&quot;X2&quot;</span>, <span class="st">&quot;Xs1&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3">bsmdl_mme &lt;-<span class="st"> </span><span class="kw">sapply</span>(variables,</a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="cf">function</span>(v) <span class="kw">shortage_probability_marginal</span>(bsmdl_fit, v),</a>
<a class="sourceLine" id="cb5-5" title="5">  <span class="dt">USE.NAMES =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb5-6" title="6">)</a>
<a class="sourceLine" id="cb5-7" title="7">drmdl_mme &lt;-<span class="st"> </span><span class="kw">sapply</span>(variables,</a>
<a class="sourceLine" id="cb5-8" title="8">  <span class="cf">function</span>(v) <span class="kw">shortage_probability_marginal</span>(drmdl_fit, v),</a>
<a class="sourceLine" id="cb5-9" title="9">  <span class="dt">USE.NAMES =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb5-10" title="10">)</a>
<a class="sourceLine" id="cb5-11" title="11">damdl_mme &lt;-<span class="st"> </span><span class="kw">sapply</span>(variables,</a>
<a class="sourceLine" id="cb5-12" title="12">  <span class="cf">function</span>(v) <span class="kw">shortage_probability_marginal</span>(damdl_fit, v),</a>
<a class="sourceLine" id="cb5-13" title="13">  <span class="dt">USE.NAMES =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb5-14" title="14">)</a>
<a class="sourceLine" id="cb5-15" title="15">samdl_mme &lt;-<span class="st"> </span><span class="kw">sapply</span>(variables,</a>
<a class="sourceLine" id="cb5-16" title="16">  <span class="cf">function</span>(v) <span class="kw">shortage_probability_marginal</span>(samdl_fit, v),</a>
<a class="sourceLine" id="cb5-17" title="17">  <span class="dt">USE.NAMES =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb5-18" title="18">)</a>
<a class="sourceLine" id="cb5-19" title="19">bsmdl_mem &lt;-<span class="st"> </span><span class="kw">sapply</span>(variables,</a>
<a class="sourceLine" id="cb5-20" title="20">  <span class="cf">function</span>(v) {</a>
<a class="sourceLine" id="cb5-21" title="21">    <span class="kw">shortage_probability_marginal</span>(bsmdl_fit, v, <span class="dt">aggregate =</span> <span class="st">&quot;at_the_mean&quot;</span>)</a>
<a class="sourceLine" id="cb5-22" title="22">  },</a>
<a class="sourceLine" id="cb5-23" title="23">  <span class="dt">USE.NAMES =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb5-24" title="24">)</a>
<a class="sourceLine" id="cb5-25" title="25">drmdl_mem &lt;-<span class="st"> </span><span class="kw">sapply</span>(variables,</a>
<a class="sourceLine" id="cb5-26" title="26">  <span class="cf">function</span>(v) {</a>
<a class="sourceLine" id="cb5-27" title="27">    <span class="kw">shortage_probability_marginal</span>(drmdl_fit, v, <span class="dt">aggregate =</span> <span class="st">&quot;at_the_mean&quot;</span>)</a>
<a class="sourceLine" id="cb5-28" title="28">  },</a>
<a class="sourceLine" id="cb5-29" title="29">  <span class="dt">USE.NAMES =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb5-30" title="30">)</a>
<a class="sourceLine" id="cb5-31" title="31">damdl_mem &lt;-<span class="st"> </span><span class="kw">sapply</span>(variables,</a>
<a class="sourceLine" id="cb5-32" title="32">  <span class="cf">function</span>(v) {</a>
<a class="sourceLine" id="cb5-33" title="33">    <span class="kw">shortage_probability_marginal</span>(damdl_fit, v, <span class="dt">aggregate =</span> <span class="st">&quot;at_the_mean&quot;</span>)</a>
<a class="sourceLine" id="cb5-34" title="34">  },</a>
<a class="sourceLine" id="cb5-35" title="35">  <span class="dt">USE.NAMES =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb5-36" title="36">)</a>
<a class="sourceLine" id="cb5-37" title="37">samdl_mem &lt;-<span class="st"> </span><span class="kw">sapply</span>(variables,</a>
<a class="sourceLine" id="cb5-38" title="38">  <span class="cf">function</span>(v) {</a>
<a class="sourceLine" id="cb5-39" title="39">    <span class="kw">shortage_probability_marginal</span>(samdl_fit, v, <span class="dt">aggregate =</span> <span class="st">&quot;at_the_mean&quot;</span>)</a>
<a class="sourceLine" id="cb5-40" title="40">  },</a>
<a class="sourceLine" id="cb5-41" title="41">  <span class="dt">USE.NAMES =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb5-42" title="42">)</a>
<a class="sourceLine" id="cb5-43" title="43"></a>
<a class="sourceLine" id="cb5-44" title="44"><span class="kw">cbind</span>(</a>
<a class="sourceLine" id="cb5-45" title="45">  bsmdl_mme, drmdl_mme, damdl_mme, samdl_mme, bsmdl_mem, drmdl_mem, damdl_mem,</a>
<a class="sourceLine" id="cb5-46" title="46">  samdl_mem</a>
<a class="sourceLine" id="cb5-47" title="47">)</a>
<a class="sourceLine" id="cb5-48" title="48"><span class="co">#&gt;          bsmdl_mme    drmdl_mme     damdl_mme    samdl_mme   bsmdl_mem</span></a>
<a class="sourceLine" id="cb5-49" title="49"><span class="co">#&gt; B_P   -0.058233417  0.074489805 -0.1651059977 -0.199290256 -0.06399195</span></a>
<a class="sourceLine" id="cb5-50" title="50"><span class="co">#&gt; D_Xd1  0.084990788  0.055358542  0.0641363526  0.067995494  0.09339528</span></a>
<a class="sourceLine" id="cb5-51" title="51"><span class="co">#&gt; D_Xd2  0.009720347  0.006209734  0.0004054397  0.004403883  0.01068156</span></a>
<a class="sourceLine" id="cb5-52" title="52"><span class="co">#&gt; B_X1   0.181968214  0.117482602  0.1923432239  0.238684040  0.19996252</span></a>
<a class="sourceLine" id="cb5-53" title="53"><span class="co">#&gt; B_X2  -0.042143710 -0.021743702 -0.0444738050 -0.056832061 -0.04631118</span></a>
<a class="sourceLine" id="cb5-54" title="54"><span class="co">#&gt; S_Xs1 -0.265232209 -0.132090709 -0.1899577770 -0.206401099 -0.29146025</span></a>
<a class="sourceLine" id="cb5-55" title="55"><span class="co">#&gt;          drmdl_mem     damdl_mem    samdl_mem</span></a>
<a class="sourceLine" id="cb5-56" title="56"><span class="co">#&gt; B_P    0.079827913 -0.1925007197 -0.252675118</span></a>
<a class="sourceLine" id="cb5-57" title="57"><span class="co">#&gt; D_Xd1  0.059325660  0.0747779862  0.086209782</span></a>
<a class="sourceLine" id="cb5-58" title="58"><span class="co">#&gt; D_Xd2  0.006654738  0.0004727111  0.005583573</span></a>
<a class="sourceLine" id="cb5-59" title="59"><span class="co">#&gt; B_X1   0.125901672  0.2242572017  0.302621508</span></a>
<a class="sourceLine" id="cb5-60" title="60"><span class="co">#&gt; B_X2  -0.023301905 -0.0518529889 -0.072055945</span></a>
<a class="sourceLine" id="cb5-61" title="61"><span class="co">#&gt; S_Xs1 -0.141556628 -0.2214759566 -0.261690778</span></a></code></pre></div>
</div>
<div id="shortages" class="section level3">
<h3>Shortages</h3>
<p>Copy the disequilibrium model <code>tibble</code> and augment it with post-estimation data. The disequilibrium models can be used to estimate:</p>
<ul>
<li><p>Shortage probabilities. These are the probabilities that the disequilibrium models assign to observing a particular extent of excess demand.</p></li>
<li><p>Normalized shortages. The point estimates of the shortages are normalized by the variance of the difference of the shocks of demand and supply.</p></li>
<li><p>Relative shortages: The point estimates of the shortages are normalized by the estimated supplied quantity.</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">mdt &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">add_column</span>(</a>
<a class="sourceLine" id="cb6-2" title="2">  bsmdl_fit<span class="op">@</span>model_tibble,</a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="dt">normalized_shortages =</span> <span class="kw">c</span>(<span class="kw">normalized_shortages</span>(bsmdl_fit)),</a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="dt">shortage_probabilities =</span> <span class="kw">c</span>(<span class="kw">shortage_probabilities</span>(bsmdl_fit)),</a>
<a class="sourceLine" id="cb6-5" title="5">  <span class="dt">relative_shortages =</span> <span class="kw">c</span>(<span class="kw">relative_shortages</span>(bsmdl_fit))</a>
<a class="sourceLine" id="cb6-6" title="6">)</a></code></pre></div>
<p>How is the sample separated post-estimation? The indices of the observations for which the estimated demand is greater than the estimated supply are easily obtained.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">abs_fitsep &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="dt">nobs =</span> <span class="kw">length</span>(<span class="kw">shortage_indicators</span>(bsmdl_fit)),</a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="dt">nshortages =</span> <span class="kw">sum</span>(<span class="kw">shortage_indicators</span>(bsmdl_fit)),</a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="dt">nsurpluses =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">shortage_indicators</span>(bsmdl_fit))</a>
<a class="sourceLine" id="cb7-5" title="5">)</a>
<a class="sourceLine" id="cb7-6" title="6"><span class="kw">print</span>(abs_fitsep)</a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt;       nobs nshortages nsurpluses </span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt;      10000       5202       4798</span></a>
<a class="sourceLine" id="cb7-9" title="9"></a>
<a class="sourceLine" id="cb7-10" title="10">rel_fitsep &lt;-<span class="st"> </span>abs_fitsep <span class="op">/</span><span class="st"> </span>abs_fitsep[<span class="st">&quot;nobs&quot;</span>]</a>
<a class="sourceLine" id="cb7-11" title="11"><span class="kw">names</span>(rel_fitsep) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;total&quot;</span>, <span class="st">&quot;shortages_share&quot;</span>, <span class="st">&quot;surpluses_share&quot;</span>)</a>
<a class="sourceLine" id="cb7-12" title="12"><span class="kw">print</span>(rel_fitsep)</a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt;           total shortages_share surpluses_share </span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt;          1.0000          0.5202          0.4798</span></a>
<a class="sourceLine" id="cb7-15" title="15"></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="cf">if</span> (<span class="kw">requireNamespace</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)) {</a>
<a class="sourceLine" id="cb7-17" title="17">  ggplot2<span class="op">::</span><span class="kw">ggplot</span>(mdt, ggplot2<span class="op">::</span><span class="kw">aes</span>(shortage_probabilities)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="st">    </span>ggplot2<span class="op">::</span><span class="kw">geom_density</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="st">    </span>ggplot2<span class="op">::</span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(</a>
<a class="sourceLine" id="cb7-20" title="20">      <span class="st">&quot;Normalized shortages density (&quot;</span>,</a>
<a class="sourceLine" id="cb7-21" title="21">      <span class="kw">model_name</span>(bsmdl_fit), <span class="st">&quot;)&quot;</span></a>
<a class="sourceLine" id="cb7-22" title="22">    )) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="st">    </span>ggplot2<span class="op">::</span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb7-24" title="24">      <span class="dt">panel.background =</span> ggplot2<span class="op">::</span><span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</a>
<a class="sourceLine" id="cb7-25" title="25">      <span class="dt">plot.background =</span> ggplot2<span class="op">::</span><span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb7-26" title="26">    )</a>
<a class="sourceLine" id="cb7-27" title="27">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="summaries" class="section level3">
<h3>Summaries</h3>
<p>All the model estimates support the <code>summary</code> function. The <code>eq_2sls</code> provides also the first stage estimation, but it is not included in the summary and has to be explicitly asked.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">summary</span>(eqmdl_reg<span class="op">@</span>fit[[<span class="dv">1</span>]]<span class="op">$</span>first_stage_model)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; lm(formula = first_stage_formula, data = object@model_tibble)</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; Residuals:</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; -4.7599 -0.8768  0.0110  0.8875  4.0701 </span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="co">#&gt; (Intercept)  5.30801    0.14560  36.455  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="co">#&gt; Xd1          0.16085    0.02596   6.196 6.02e-10 ***</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="co">#&gt; Xd2         -0.01098    0.02570  -0.427    0.669    </span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="co">#&gt; X1           0.51332    0.02579  19.907  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co">#&gt; X2          -0.12027    0.02573  -4.674 3.00e-06 ***</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="co">#&gt; Xs1         -0.43902    0.02591 -16.943  &lt; 2e-16 ***</span></a>
<a class="sourceLine" id="cb8-18" title="18"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-21" title="21"><span class="co">#&gt; Residual standard error: 1.285 on 9994 degrees of freedom</span></a>
<a class="sourceLine" id="cb8-22" title="22"><span class="co">#&gt; Multiple R-squared:  0.06945,    Adjusted R-squared:  0.06898 </span></a>
<a class="sourceLine" id="cb8-23" title="23"><span class="co">#&gt; F-statistic: 149.2 on 5 and 9994 DF,  p-value: &lt; 2.2e-16</span></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="kw">summary</span>(eqmdl_reg)</a>
<a class="sourceLine" id="cb8-25" title="25"><span class="co">#&gt; Equilibrium Model for Markets in Equilibrium</span></a>
<a class="sourceLine" id="cb8-26" title="26"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb8-27" title="27"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb8-28" title="28"><span class="co">#&gt;   Market Clearing   : Q = D_Q = S_Q</span></a>
<a class="sourceLine" id="cb8-29" title="29"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb8-30" title="30"><span class="co">#&gt;   Nobs              : 10000</span></a>
<a class="sourceLine" id="cb8-31" title="31"><span class="co">#&gt;   Sample Separation : Not Separated</span></a>
<a class="sourceLine" id="cb8-32" title="32"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb8-33" title="33"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb8-34" title="34"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb8-35" title="35"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb8-36" title="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-37" title="37"><span class="co">#&gt; systemfit results </span></a>
<a class="sourceLine" id="cb8-38" title="38"><span class="co">#&gt; method: 2SLS </span></a>
<a class="sourceLine" id="cb8-39" title="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-40" title="40"><span class="co">#&gt;            N    DF     SSR detRCov   OLS-R2 McElroy-R2</span></a>
<a class="sourceLine" id="cb8-41" title="41"><span class="co">#&gt; system 20000 19989 48358.5  4.6502 -2.12978  -0.739797</span></a>
<a class="sourceLine" id="cb8-42" title="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-43" title="43"><span class="co">#&gt;            N   DF     SSR     MSE    RMSE       R2   Adj R2</span></a>
<a class="sourceLine" id="cb8-44" title="44"><span class="co">#&gt; demand 10000 9994 27698.3 2.77149 1.66478 -2.58529 -2.58708</span></a>
<a class="sourceLine" id="cb8-45" title="45"><span class="co">#&gt; supply 10000 9995 20660.2 2.06706 1.43773 -1.67428 -1.67535</span></a>
<a class="sourceLine" id="cb8-46" title="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-47" title="47"><span class="co">#&gt; The covariance matrix of the residuals</span></a>
<a class="sourceLine" id="cb8-48" title="48"><span class="co">#&gt;          demand   supply</span></a>
<a class="sourceLine" id="cb8-49" title="49"><span class="co">#&gt; demand  2.77149 -1.03857</span></a>
<a class="sourceLine" id="cb8-50" title="50"><span class="co">#&gt; supply -1.03857  2.06706</span></a>
<a class="sourceLine" id="cb8-51" title="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-52" title="52"><span class="co">#&gt; The correlations of the residuals</span></a>
<a class="sourceLine" id="cb8-53" title="53"><span class="co">#&gt;           demand    supply</span></a>
<a class="sourceLine" id="cb8-54" title="54"><span class="co">#&gt; demand  1.000000 -0.433914</span></a>
<a class="sourceLine" id="cb8-55" title="55"><span class="co">#&gt; supply -0.433914  1.000000</span></a>
<a class="sourceLine" id="cb8-56" title="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-57" title="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-58" title="58"><span class="co">#&gt; 2SLS estimates for &#39;demand&#39; (equation 1)</span></a>
<a class="sourceLine" id="cb8-59" title="59"><span class="co">#&gt; Model Formula: Q ~ P + Xd1 + Xd2 + X1 + X2</span></a>
<a class="sourceLine" id="cb8-60" title="60"><span class="co">#&gt; &lt;environment: 0x5649889a93b8&gt;</span></a>
<a class="sourceLine" id="cb8-61" title="61"><span class="co">#&gt; Instruments: ~Xd1 + Xd2 + X1 + X2 + Xs1</span></a>
<a class="sourceLine" id="cb8-62" title="62"><span class="co">#&gt; &lt;environment: 0x5649889a93b8&gt;</span></a>
<a class="sourceLine" id="cb8-63" title="63"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-64" title="64"><span class="co">#&gt;               Estimate Std. Error   t value   Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb8-65" title="65"><span class="co">#&gt; (Intercept)  9.7549133  0.3627929  26.88838 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb8-66" title="66"><span class="co">#&gt; P           -0.9575689  0.0764469 -12.52594 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb8-67" title="67"><span class="co">#&gt; Xd1          0.3306545  0.0358080   9.23409 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb8-68" title="68"><span class="co">#&gt; Xd2         -0.0012847  0.0333156  -0.03856  0.9692408    </span></a>
<a class="sourceLine" id="cb8-69" title="69"><span class="co">#&gt; X1           0.5778408  0.0516015  11.19815 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb8-70" title="70"><span class="co">#&gt; X2          -0.0893816  0.0344208  -2.59673  0.0094254 ** </span></a>
<a class="sourceLine" id="cb8-71" title="71"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb8-72" title="72"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb8-73" title="73"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-74" title="74"><span class="co">#&gt; Residual standard error: 1.66478 on 9994 degrees of freedom</span></a>
<a class="sourceLine" id="cb8-75" title="75"><span class="co">#&gt; Number of observations: 10000 Degrees of Freedom: 9994 </span></a>
<a class="sourceLine" id="cb8-76" title="76"><span class="co">#&gt; SSR: 27698.280302 MSE: 2.771491 Root MSE: 1.66478 </span></a>
<a class="sourceLine" id="cb8-77" title="77"><span class="co">#&gt; Multiple R-Squared: -2.585289 Adjusted R-Squared: -2.587082 </span></a>
<a class="sourceLine" id="cb8-78" title="78"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-79" title="79"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-80" title="80"><span class="co">#&gt; 2SLS estimates for &#39;supply&#39; (equation 2)</span></a>
<a class="sourceLine" id="cb8-81" title="81"><span class="co">#&gt; Model Formula: Q ~ P + Xs1 + X1 + X2</span></a>
<a class="sourceLine" id="cb8-82" title="82"><span class="co">#&gt; &lt;environment: 0x5649889a93b8&gt;</span></a>
<a class="sourceLine" id="cb8-83" title="83"><span class="co">#&gt; Instruments: ~Xd1 + Xd2 + X1 + X2 + Xs1</span></a>
<a class="sourceLine" id="cb8-84" title="84"><span class="co">#&gt; &lt;environment: 0x5649889a93b8&gt;</span></a>
<a class="sourceLine" id="cb8-85" title="85"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-86" title="86"><span class="co">#&gt;               Estimate Std. Error  t value   Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb8-87" title="87"><span class="co">#&gt; (Intercept) -1.0494025  1.0315906 -1.01727    0.30905    </span></a>
<a class="sourceLine" id="cb8-88" title="88"><span class="co">#&gt; P            1.0884357  0.1800529  6.04509 1.5467e-09 ***</span></a>
<a class="sourceLine" id="cb8-89" title="89"><span class="co">#&gt; Xs1          0.8985423  0.0842354 10.66703 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb8-90" title="90"><span class="co">#&gt; X1          -0.4723384  0.0968275 -4.87814 1.0874e-06 ***</span></a>
<a class="sourceLine" id="cb8-91" title="91"><span class="co">#&gt; X2           0.1566904  0.0361420  4.33541 1.4691e-05 ***</span></a>
<a class="sourceLine" id="cb8-92" title="92"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb8-93" title="93"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb8-94" title="94"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-95" title="95"><span class="co">#&gt; Residual standard error: 1.437727 on 9995 degrees of freedom</span></a>
<a class="sourceLine" id="cb8-96" title="96"><span class="co">#&gt; Number of observations: 10000 Degrees of Freedom: 9995 </span></a>
<a class="sourceLine" id="cb8-97" title="97"><span class="co">#&gt; SSR: 20660.242409 MSE: 2.067058 Root MSE: 1.437727 </span></a>
<a class="sourceLine" id="cb8-98" title="98"><span class="co">#&gt; Multiple R-Squared: -1.674279 Adjusted R-Squared: -1.675349</span></a>
<a class="sourceLine" id="cb8-99" title="99"><span class="kw">summary</span>(eqmdl_fit)</a>
<a class="sourceLine" id="cb8-100" title="100"><span class="co">#&gt; Equilibrium Model for Markets in Equilibrium</span></a>
<a class="sourceLine" id="cb8-101" title="101"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb8-102" title="102"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb8-103" title="103"><span class="co">#&gt;   Market Clearing   : Q = D_Q = S_Q</span></a>
<a class="sourceLine" id="cb8-104" title="104"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb8-105" title="105"><span class="co">#&gt;   Nobs              : 10000</span></a>
<a class="sourceLine" id="cb8-106" title="106"><span class="co">#&gt;   Sample Separation : Not Separated</span></a>
<a class="sourceLine" id="cb8-107" title="107"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb8-108" title="108"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb8-109" title="109"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb8-110" title="110"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb8-111" title="111"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-112" title="112"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb8-113" title="113"><span class="co">#&gt;   Method              : BFGS</span></a>
<a class="sourceLine" id="cb8-114" title="114"><span class="co">#&gt;   Convergence Status  : success</span></a>
<a class="sourceLine" id="cb8-115" title="115"><span class="co">#&gt;   Starting Values     :</span></a>
<a class="sourceLine" id="cb8-116" title="116"><span class="co">#&gt;        D_P    D_CONST      D_Xd1      D_Xd2       D_X1       D_X2        S_P </span></a>
<a class="sourceLine" id="cb8-117" title="117"><span class="co">#&gt;    0.13815    5.15047    0.15414    0.01746    0.01405    0.03411    0.17315 </span></a>
<a class="sourceLine" id="cb8-118" title="118"><span class="co">#&gt;    S_CONST      S_Xs1       S_X1       S_X2 D_VARIANCE S_VARIANCE        RHO </span></a>
<a class="sourceLine" id="cb8-119" title="119"><span class="co">#&gt;    4.15459    0.49648   -0.00247    0.04558    1.00000    1.00000    0.00000 </span></a>
<a class="sourceLine" id="cb8-120" title="120"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-121" title="121"><span class="co">#&gt; Coefficients</span></a>
<a class="sourceLine" id="cb8-122" title="122"><span class="co">#&gt;            Estimate Std. Error  z value      Pr(z)</span></a>
<a class="sourceLine" id="cb8-123" title="123"><span class="co">#&gt; D_P        -1.01247    0.09858 -10.2708  9.545e-25</span></a>
<a class="sourceLine" id="cb8-124" title="124"><span class="co">#&gt; D_CONST    10.89751    0.47798  22.7991 4.679e-115</span></a>
<a class="sourceLine" id="cb8-125" title="125"><span class="co">#&gt; D_Xd1      -0.01743    0.01240  -1.4053  1.599e-01</span></a>
<a class="sourceLine" id="cb8-126" title="126"><span class="co">#&gt; D_Xd2      -0.00890    0.01151  -0.7736  4.392e-01</span></a>
<a class="sourceLine" id="cb8-127" title="127"><span class="co">#&gt; D_X1        0.60912    0.06310   9.6530  4.776e-22</span></a>
<a class="sourceLine" id="cb8-128" title="128"><span class="co">#&gt; D_X2       -0.10000    0.03720  -2.6880  7.187e-03</span></a>
<a class="sourceLine" id="cb8-129" title="129"><span class="co">#&gt; S_P        -0.41615    0.01485 -28.0313 6.748e-173</span></a>
<a class="sourceLine" id="cb8-130" title="130"><span class="co">#&gt; S_CONST     7.46659    0.03056 244.2868  0.000e+00</span></a>
<a class="sourceLine" id="cb8-131" title="131"><span class="co">#&gt; S_Xs1       0.25233    0.02374  10.6298  2.167e-26</span></a>
<a class="sourceLine" id="cb8-132" title="132"><span class="co">#&gt; S_X1        0.30159    0.02790  10.8096  3.102e-27</span></a>
<a class="sourceLine" id="cb8-133" title="133"><span class="co">#&gt; S_X2       -0.02675    0.02167  -1.2343  2.171e-01</span></a>
<a class="sourceLine" id="cb8-134" title="134"><span class="co">#&gt; D_VARIANCE  3.01149    0.39228   7.6770  1.629e-14</span></a>
<a class="sourceLine" id="cb8-135" title="135"><span class="co">#&gt; S_VARIANCE  1.25304    0.03285  38.1432  0.000e+00</span></a>
<a class="sourceLine" id="cb8-136" title="136"><span class="co">#&gt; RHO         0.94562    0.01006  93.9638  0.000e+00</span></a>
<a class="sourceLine" id="cb8-137" title="137"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-138" title="138"><span class="co">#&gt; -2 log L: 57914.5</span></a>
<a class="sourceLine" id="cb8-139" title="139"><span class="kw">summary</span>(bsmdl_fit)</a>
<a class="sourceLine" id="cb8-140" title="140"><span class="co">#&gt; Basic Model for Markets in Disequilibrium</span></a>
<a class="sourceLine" id="cb8-141" title="141"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb8-142" title="142"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb8-143" title="143"><span class="co">#&gt;   Short Side Rule   : Q = min(D_Q, S_Q)</span></a>
<a class="sourceLine" id="cb8-144" title="144"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb8-145" title="145"><span class="co">#&gt;   Nobs              : 10000</span></a>
<a class="sourceLine" id="cb8-146" title="146"><span class="co">#&gt;   Sample Separation : Not Separated</span></a>
<a class="sourceLine" id="cb8-147" title="147"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb8-148" title="148"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb8-149" title="149"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb8-150" title="150"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb8-151" title="151"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-152" title="152"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb8-153" title="153"><span class="co">#&gt;   Method              : Nelder-Mead</span></a>
<a class="sourceLine" id="cb8-154" title="154"><span class="co">#&gt;   Max Iterations      : 100000</span></a>
<a class="sourceLine" id="cb8-155" title="155"><span class="co">#&gt;   Convergence Status  : success</span></a>
<a class="sourceLine" id="cb8-156" title="156"><span class="co">#&gt;   Starting Values     :</span></a>
<a class="sourceLine" id="cb8-157" title="157"><span class="co">#&gt;        D_P    D_CONST      D_Xd1      D_Xd2       D_X1       D_X2        S_P </span></a>
<a class="sourceLine" id="cb8-158" title="158"><span class="co">#&gt;    0.13815    5.15047    0.15414    0.01746    0.01405    0.03411    0.17315 </span></a>
<a class="sourceLine" id="cb8-159" title="159"><span class="co">#&gt;    S_CONST      S_Xs1       S_X1       S_X2 D_VARIANCE S_VARIANCE        RHO </span></a>
<a class="sourceLine" id="cb8-160" title="160"><span class="co">#&gt;    4.15459    0.49648   -0.00247    0.04558    1.00000    1.00000    0.00000 </span></a>
<a class="sourceLine" id="cb8-161" title="161"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-162" title="162"><span class="co">#&gt; Coefficients</span></a>
<a class="sourceLine" id="cb8-163" title="163"><span class="co">#&gt;            Estimate Std. Error z value      Pr(z)</span></a>
<a class="sourceLine" id="cb8-164" title="164"><span class="co">#&gt; D_P         0.06505    0.02562  2.5387  1.113e-02</span></a>
<a class="sourceLine" id="cb8-165" title="165"><span class="co">#&gt; D_CONST     5.12574    0.21738 23.5795 6.252e-123</span></a>
<a class="sourceLine" id="cb8-166" title="166"><span class="co">#&gt; D_Xd1       0.29708    0.05483  5.4184  6.013e-08</span></a>
<a class="sourceLine" id="cb8-167" title="167"><span class="co">#&gt; D_Xd2       0.03398    0.03204  1.0604  2.889e-01</span></a>
<a class="sourceLine" id="cb8-168" title="168"><span class="co">#&gt; D_X1        0.32469    0.10101  3.2145  1.307e-03</span></a>
<a class="sourceLine" id="cb8-169" title="169"><span class="co">#&gt; D_X2       -0.03387    0.06251 -0.5418  5.879e-01</span></a>
<a class="sourceLine" id="cb8-170" title="170"><span class="co">#&gt; S_P         0.26860    0.02541 10.5717  4.031e-26</span></a>
<a class="sourceLine" id="cb8-171" title="171"><span class="co">#&gt; S_CONST     3.68315    0.25270 14.5749  4.056e-48</span></a>
<a class="sourceLine" id="cb8-172" title="172"><span class="co">#&gt; S_Xs1       0.92709    0.14013  6.6161  3.687e-11</span></a>
<a class="sourceLine" id="cb8-173" title="173"><span class="co">#&gt; S_X1       -0.31137    0.06729 -4.6271  3.708e-06</span></a>
<a class="sourceLine" id="cb8-174" title="174"><span class="co">#&gt; S_X2        0.11344    0.05179  2.1905  2.849e-02</span></a>
<a class="sourceLine" id="cb8-175" title="175"><span class="co">#&gt; D_VARIANCE  0.82064    0.03941 20.8252  2.557e-96</span></a>
<a class="sourceLine" id="cb8-176" title="176"><span class="co">#&gt; S_VARIANCE  0.99711    0.15989  6.2362  4.485e-10</span></a>
<a class="sourceLine" id="cb8-177" title="177"><span class="co">#&gt; RHO         0.11547    0.15802  0.7308  4.649e-01</span></a>
<a class="sourceLine" id="cb8-178" title="178"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-179" title="179"><span class="co">#&gt; -2 log L: 24362.3</span></a>
<a class="sourceLine" id="cb8-180" title="180"><span class="kw">summary</span>(damdl_fit)</a>
<a class="sourceLine" id="cb8-181" title="181"><span class="co">#&gt; Deterministic Adjustment Model for Markets in Disequilibrium</span></a>
<a class="sourceLine" id="cb8-182" title="182"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb8-183" title="183"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb8-184" title="184"><span class="co">#&gt;   Short Side Rule   : Q = min(D_Q, S_Q)</span></a>
<a class="sourceLine" id="cb8-185" title="185"><span class="co">#&gt;   Separation Rule   : P_DIFF analogous to (D_Q - S_Q)</span></a>
<a class="sourceLine" id="cb8-186" title="186"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb8-187" title="187"><span class="co">#&gt;   Nobs              : 8000</span></a>
<a class="sourceLine" id="cb8-188" title="188"><span class="co">#&gt;   Sample Separation : Demand Obs = 2540, Supply Obs = 5460</span></a>
<a class="sourceLine" id="cb8-189" title="189"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb8-190" title="190"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb8-191" title="191"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb8-192" title="192"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb8-193" title="193"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-194" title="194"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb8-195" title="195"><span class="co">#&gt;   Method              : BFGS</span></a>
<a class="sourceLine" id="cb8-196" title="196"><span class="co">#&gt;   Convergence Status  : success</span></a>
<a class="sourceLine" id="cb8-197" title="197"><span class="co">#&gt;   Starting Values     :</span></a>
<a class="sourceLine" id="cb8-198" title="198"><span class="co">#&gt;        D_P    D_CONST      D_Xd1      D_Xd2       D_X1       D_X2        S_P </span></a>
<a class="sourceLine" id="cb8-199" title="199"><span class="co">#&gt;    0.10164    5.23014    0.16768    0.01574    0.09549    0.01532    0.14235 </span></a>
<a class="sourceLine" id="cb8-200" title="200"><span class="co">#&gt;    S_CONST      S_Xs1       S_X1       S_X2     P_DIFF D_VARIANCE S_VARIANCE </span></a>
<a class="sourceLine" id="cb8-201" title="201"><span class="co">#&gt;    4.38416    0.43711    0.07416    0.02458    1.00000    1.00000    1.00000 </span></a>
<a class="sourceLine" id="cb8-202" title="202"><span class="co">#&gt;        RHO </span></a>
<a class="sourceLine" id="cb8-203" title="203"><span class="co">#&gt;    0.00000 </span></a>
<a class="sourceLine" id="cb8-204" title="204"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-205" title="205"><span class="co">#&gt; Coefficients</span></a>
<a class="sourceLine" id="cb8-206" title="206"><span class="co">#&gt;            Estimate Std. Error   z value      Pr(z)</span></a>
<a class="sourceLine" id="cb8-207" title="207"><span class="co">#&gt; D_P        -0.18260    0.01688 -10.81970  2.777e-27</span></a>
<a class="sourceLine" id="cb8-208" title="208"><span class="co">#&gt; D_CONST     6.69333    0.12727  52.59287  0.000e+00</span></a>
<a class="sourceLine" id="cb8-209" title="209"><span class="co">#&gt; D_Xd1       0.16451    0.02071   7.94236  1.984e-15</span></a>
<a class="sourceLine" id="cb8-210" title="210"><span class="co">#&gt; D_Xd2       0.00104    0.01802   0.05773  9.540e-01</span></a>
<a class="sourceLine" id="cb8-211" title="211"><span class="co">#&gt; D_X1        0.43124    0.02687  16.04867  5.841e-58</span></a>
<a class="sourceLine" id="cb8-212" title="212"><span class="co">#&gt; D_X2       -0.06011    0.02328  -2.58213  9.819e-03</span></a>
<a class="sourceLine" id="cb8-213" title="213"><span class="co">#&gt; S_P         0.24090    0.01519  15.86368  1.131e-56</span></a>
<a class="sourceLine" id="cb8-214" title="214"><span class="co">#&gt; S_CONST     4.06253    0.12682  32.03405 3.662e-225</span></a>
<a class="sourceLine" id="cb8-215" title="215"><span class="co">#&gt; S_Xs1       0.48725    0.02328  20.93164  2.758e-97</span></a>
<a class="sourceLine" id="cb8-216" title="216"><span class="co">#&gt; S_X1       -0.06213    0.02177  -2.85453  4.310e-03</span></a>
<a class="sourceLine" id="cb8-217" title="217"><span class="co">#&gt; S_X2        0.05397    0.01886   2.86180  4.212e-03</span></a>
<a class="sourceLine" id="cb8-218" title="218"><span class="co">#&gt; P_DIFF      0.52648    0.02202  23.91277 2.256e-126</span></a>
<a class="sourceLine" id="cb8-219" title="219"><span class="co">#&gt; D_VARIANCE  1.02178    0.03318  30.79873 2.725e-208</span></a>
<a class="sourceLine" id="cb8-220" title="220"><span class="co">#&gt; S_VARIANCE  0.69727    0.01339  52.06415  0.000e+00</span></a>
<a class="sourceLine" id="cb8-221" title="221"><span class="co">#&gt; RHO         0.60944    0.02733  22.29848 3.823e-110</span></a>
<a class="sourceLine" id="cb8-222" title="222"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-223" title="223"><span class="co">#&gt; -2 log L: 39800.3</span></a>
<a class="sourceLine" id="cb8-224" title="224"><span class="kw">summary</span>(samdl_fit)</a>
<a class="sourceLine" id="cb8-225" title="225"><span class="co">#&gt; Stochastic Adjustment Model for Markets in Disequilibrium</span></a>
<a class="sourceLine" id="cb8-226" title="226"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb8-227" title="227"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb8-228" title="228"><span class="co">#&gt;   Price Dynamics RHS: (D_Q - S_Q) + Xp1</span></a>
<a class="sourceLine" id="cb8-229" title="229"><span class="co">#&gt;   Short Side Rule   : Q = min(D_Q, S_Q)</span></a>
<a class="sourceLine" id="cb8-230" title="230"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb8-231" title="231"><span class="co">#&gt;   Nobs              : 8000</span></a>
<a class="sourceLine" id="cb8-232" title="232"><span class="co">#&gt;   Sample Separation : Not Separated</span></a>
<a class="sourceLine" id="cb8-233" title="233"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb8-234" title="234"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb8-235" title="235"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb8-236" title="236"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb8-237" title="237"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-238" title="238"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb8-239" title="239"><span class="co">#&gt;   Method              : BFGS</span></a>
<a class="sourceLine" id="cb8-240" title="240"><span class="co">#&gt;   Max Iterations      : 100000</span></a>
<a class="sourceLine" id="cb8-241" title="241"><span class="co">#&gt;   Convergence Status  : success</span></a>
<a class="sourceLine" id="cb8-242" title="242"><span class="co">#&gt;   Starting Values     :</span></a>
<a class="sourceLine" id="cb8-243" title="243"><span class="co">#&gt;        D_P    D_CONST      D_Xd1      D_Xd2       D_X1       D_X2        S_P </span></a>
<a class="sourceLine" id="cb8-244" title="244"><span class="co">#&gt;    0.10164    5.23014    0.16768    0.01574    0.09549    0.01532    0.14235 </span></a>
<a class="sourceLine" id="cb8-245" title="245"><span class="co">#&gt;    S_CONST      S_Xs1       S_X1       S_X2     P_DIFF    P_CONST      P_Xp1 </span></a>
<a class="sourceLine" id="cb8-246" title="246"><span class="co">#&gt;    4.38416    0.43711    0.07416    0.02458   14.18100    3.31715   -0.98643 </span></a>
<a class="sourceLine" id="cb8-247" title="247"><span class="co">#&gt; D_VARIANCE S_VARIANCE P_VARIANCE     RHO_DS     RHO_DP     RHO_SP </span></a>
<a class="sourceLine" id="cb8-248" title="248"><span class="co">#&gt;    1.00000    1.00000    1.00000    0.00000    0.00000    0.00000 </span></a>
<a class="sourceLine" id="cb8-249" title="249"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-250" title="250"><span class="co">#&gt; Coefficients</span></a>
<a class="sourceLine" id="cb8-251" title="251"><span class="co">#&gt;             Estimate Std. Error   z value     Pr(z)</span></a>
<a class="sourceLine" id="cb8-252" title="252"><span class="co">#&gt; D_P        -0.283818    0.02445 -11.60957 3.685e-31</span></a>
<a class="sourceLine" id="cb8-253" title="253"><span class="co">#&gt; D_CONST     6.670856    0.16883  39.51312 0.000e+00</span></a>
<a class="sourceLine" id="cb8-254" title="254"><span class="co">#&gt; D_Xd1       0.295357    0.02671  11.05871 1.989e-28</span></a>
<a class="sourceLine" id="cb8-255" title="255"><span class="co">#&gt; D_Xd2       0.019129    0.02557   0.74827 4.543e-01</span></a>
<a class="sourceLine" id="cb8-256" title="256"><span class="co">#&gt; D_X1        0.572856    0.03683  15.55230 1.535e-54</span></a>
<a class="sourceLine" id="cb8-257" title="257"><span class="co">#&gt; D_X2       -0.092642    0.02612  -3.54740 3.891e-04</span></a>
<a class="sourceLine" id="cb8-258" title="258"><span class="co">#&gt; S_P         0.581854    0.04519  12.87565 6.172e-38</span></a>
<a class="sourceLine" id="cb8-259" title="259"><span class="co">#&gt; S_CONST     2.178987    0.24712   8.81755 1.170e-18</span></a>
<a class="sourceLine" id="cb8-260" title="260"><span class="co">#&gt; S_Xs1       0.896560    0.05190  17.27636 7.088e-67</span></a>
<a class="sourceLine" id="cb8-261" title="261"><span class="co">#&gt; S_X1       -0.463933    0.05749  -8.06931 7.070e-16</span></a>
<a class="sourceLine" id="cb8-262" title="262"><span class="co">#&gt; S_X2        0.154224    0.02928   5.26759 1.382e-07</span></a>
<a class="sourceLine" id="cb8-263" title="263"><span class="co">#&gt; P_DIFF      1.126426    0.06007  18.75213 1.860e-78</span></a>
<a class="sourceLine" id="cb8-264" title="264"><span class="co">#&gt; P_CONST     0.915931    0.11227   8.15807 3.404e-16</span></a>
<a class="sourceLine" id="cb8-265" title="265"><span class="co">#&gt; P_Xp1      -0.122637    0.03249  -3.77465 1.602e-04</span></a>
<a class="sourceLine" id="cb8-266" title="266"><span class="co">#&gt; D_VARIANCE  0.986643    0.05123  19.25817 1.206e-82</span></a>
<a class="sourceLine" id="cb8-267" title="267"><span class="co">#&gt; S_VARIANCE  1.005088    0.08611  11.67199 1.772e-31</span></a>
<a class="sourceLine" id="cb8-268" title="268"><span class="co">#&gt; P_VARIANCE  0.898735    0.10383   8.65587 4.892e-18</span></a>
<a class="sourceLine" id="cb8-269" title="269"><span class="co">#&gt; RHO_DS      0.066835    0.09213   0.72546 4.682e-01</span></a>
<a class="sourceLine" id="cb8-270" title="270"><span class="co">#&gt; RHO_DP      0.005708    0.06837   0.08349 9.335e-01</span></a>
<a class="sourceLine" id="cb8-271" title="271"><span class="co">#&gt; RHO_SP     -0.006082    0.06801  -0.08943 9.287e-01</span></a>
<a class="sourceLine" id="cb8-272" title="272"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-273" title="273"><span class="co">#&gt; -2 log L: 39505.1</span></a></code></pre></div>
<p>The estimated demanded and supplied quantities can be calculated per observation.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">market &lt;-<span class="st"> </span><span class="kw">cbind</span>(</a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="dt">demand =</span> <span class="kw">demanded_quantities</span>(bsmdl_fit)[, <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb9-3" title="3">  <span class="dt">supply =</span> <span class="kw">supplied_quantities</span>(bsmdl_fit)[, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb9-4" title="4">)</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="kw">summary</span>(market)</a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt;      demand          supply     </span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="co">#&gt;  Min.   :6.103   Min.   :4.863  </span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt;  1st Qu.:6.873   1st Qu.:6.638  </span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co">#&gt;  Median :7.043   Median :7.010  </span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt;  Mean   :7.042   Mean   :7.003  </span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#&gt;  3rd Qu.:7.209   3rd Qu.:7.369  </span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="co">#&gt;  Max.   :8.093   Max.   :9.137</span></a></code></pre></div>
<p>The package offers also basic aggregation functionality.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">aggregates &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="dt">demand =</span> <span class="kw">aggregate_demand</span>(bsmdl_fit),</a>
<a class="sourceLine" id="cb10-3" title="3">  <span class="dt">supply =</span> <span class="kw">aggregate_supply</span>(bsmdl_fit)</a>
<a class="sourceLine" id="cb10-4" title="4">)</a>
<a class="sourceLine" id="cb10-5" title="5">aggregates</a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; $demand.date</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="co">#&gt; [1] 1 2 3 4 5</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt; Levels: 1 2 3 4 5</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt; $demand.D_Q</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="co">#&gt; [1] 13913.91 14052.51 14115.25 14152.94 14181.93</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="co">#&gt; $supply.date</span></a>
<a class="sourceLine" id="cb10-14" title="14"><span class="co">#&gt; [1] 1 2 3 4 5</span></a>
<a class="sourceLine" id="cb10-15" title="15"><span class="co">#&gt; Levels: 1 2 3 4 5</span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co">#&gt; $supply.S_Q</span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="co">#&gt; [1] 13277.40 13851.89 14140.81 14351.21 14412.80</span></a></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
