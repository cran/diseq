<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>An example of market-clearing assessment</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">An example of market-clearing assessment</h1>



<p>This short tutorial gives an example of how one can statistically assess whether a market is in an equilibrium state. The tutorial assumes some familiarity with the concepts and the functionality of the package. The <a href="basic_usage.html">basic_usage</a> vignette can be helpful in acquiring this familiarity.</p>
<div id="setup-the-environment" class="section level2">
<h2>Setup the environment</h2>
<p>Load the required libraries.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(diseq)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(magrittr)</span></code></pre></div>
<p>Prepare the data. Here, we simply simulate data using a data generating process for a market in equilibrium.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>nobs &lt;-<span class="st"> </span><span class="dv">5000</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>tobs &lt;-<span class="st"> </span><span class="dv">5</span></span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a>alpha_d &lt;-<span class="st"> </span><span class="fl">-1.9</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>beta_d0 &lt;-<span class="st"> </span><span class="fl">4.9</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>beta_d &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.1</span>, <span class="fl">-0.7</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>eta_d &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">6.25</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a>alpha_s &lt;-<span class="st"> </span><span class="fl">2.8</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>beta_s0 &lt;-<span class="st"> </span><span class="fl">1.2</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>beta_s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.65</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a>eta_s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.15</span>, <span class="fl">4.2</span>)</span>
<span id="cb2-13"><a href="#cb2-13"></a></span>
<span id="cb2-14"><a href="#cb2-14"></a>sigma_d &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>sigma_s &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>rho_ds &lt;-<span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a>seed &lt;-<span class="st"> </span><span class="dv">443</span></span>
<span id="cb2-19"><a href="#cb2-19"></a></span>
<span id="cb2-20"><a href="#cb2-20"></a>eq_data &lt;-<span class="st"> </span><span class="kw">simulate_model_data</span>(</span>
<span id="cb2-21"><a href="#cb2-21"></a>  <span class="st">&quot;equilibrium_model&quot;</span>, nobs, tobs,</span>
<span id="cb2-22"><a href="#cb2-22"></a>  alpha_d, beta_d0, beta_d, eta_d,</span>
<span id="cb2-23"><a href="#cb2-23"></a>  alpha_s, beta_s0, beta_s, eta_s,</span>
<span id="cb2-24"><a href="#cb2-24"></a>  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="kw">c</span>(<span class="ot">NA</span>),</span>
<span id="cb2-25"><a href="#cb2-25"></a>  <span class="dt">sigma_d =</span> sigma_d, <span class="dt">sigma_s =</span> sigma_s, <span class="dt">rho_ds =</span> rho_ds,</span>
<span id="cb2-26"><a href="#cb2-26"></a>  <span class="dt">seed =</span> seed</span>
<span id="cb2-27"><a href="#cb2-27"></a>)</span></code></pre></div>
</div>
<div id="initialize-the-model" class="section level2">
<h2>Initialize the model</h2>
<p>Prepare the basic parameters for model initialization.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>key_columns &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;date&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>time_column &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;date&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>quantity_column &lt;-<span class="st"> &quot;Q&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>price_column &lt;-<span class="st"> &quot;P&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>demand_specification &lt;-<span class="st"> </span><span class="kw">paste0</span>(price_column, <span class="st">&quot; + Xd1 + Xd2 + X1 + X2&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>supply_specification &lt;-<span class="st"> &quot;Xs1 + X1 + X2&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>price_specification &lt;-<span class="st"> &quot;Xp1&quot;</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>verbose &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>use_correlated_shocks &lt;-<span class="st"> </span><span class="ot">TRUE</span></span></code></pre></div>
<p>Using the above parameterization, construct the model objects. Here we construct two equilibrium models and four disequilibrium models. All the models are constructed using the simulated data from a model of market in equilibrium.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>eqmdl &lt;-<span class="st"> </span><span class="kw">new</span>(</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="st">&quot;equilibrium_model&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3"></a>  key_columns,</span>
<span id="cb4-4"><a href="#cb4-4"></a>  quantity_column, price_column,</span>
<span id="cb4-5"><a href="#cb4-5"></a>  demand_specification, <span class="kw">paste0</span>(price_column, <span class="st">&quot; + &quot;</span>, supply_specification),</span>
<span id="cb4-6"><a href="#cb4-6"></a>  eq_data[eq_data<span class="op">$</span>date <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>, ],</span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="dt">use_correlated_shocks =</span> use_correlated_shocks, <span class="dt">verbose =</span> verbose</span>
<span id="cb4-8"><a href="#cb4-8"></a>)</span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt; Info: This is &#39;Equilibrium FIML with correlated shocks&#39; model</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt; Warning: Problem with `mutate()` input `date`.</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt; ℹ Removing unobserved &#39;1&#39; level(s).</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; </span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt; ℹ Input `date` is `(function (x) ...`.</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt; Warning: Removing unobserved &#39;1&#39; level(s).</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>bsmdl &lt;-<span class="st"> </span><span class="kw">new</span>(</span>
<span id="cb4-16"><a href="#cb4-16"></a>  <span class="st">&quot;diseq_basic&quot;</span>,</span>
<span id="cb4-17"><a href="#cb4-17"></a>  key_columns,</span>
<span id="cb4-18"><a href="#cb4-18"></a>  quantity_column, price_column,</span>
<span id="cb4-19"><a href="#cb4-19"></a>  demand_specification, <span class="kw">paste0</span>(price_column, <span class="st">&quot; + &quot;</span>, supply_specification),</span>
<span id="cb4-20"><a href="#cb4-20"></a>  eq_data[eq_data<span class="op">$</span>date <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>, ],</span>
<span id="cb4-21"><a href="#cb4-21"></a>  <span class="dt">use_correlated_shocks =</span> use_correlated_shocks, <span class="dt">verbose =</span> verbose</span>
<span id="cb4-22"><a href="#cb4-22"></a>)</span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="co">#&gt; Info: This is &#39;Basic with correlated shocks&#39; model</span></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="co">#&gt; Warning: Problem with `mutate()` input `date`.</span></span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="co">#&gt; ℹ Removing unobserved &#39;1&#39; level(s).</span></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="co">#&gt; </span></span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="co">#&gt; ℹ Input `date` is `(function (x) ...`.</span></span>
<span id="cb4-28"><a href="#cb4-28"></a></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="co">#&gt; Warning: Removing unobserved &#39;1&#39; level(s).</span></span>
<span id="cb4-30"><a href="#cb4-30"></a>damdl &lt;-<span class="st"> </span><span class="kw">new</span>(</span>
<span id="cb4-31"><a href="#cb4-31"></a>  <span class="st">&quot;diseq_deterministic_adjustment&quot;</span>,</span>
<span id="cb4-32"><a href="#cb4-32"></a>  key_columns, time_column,</span>
<span id="cb4-33"><a href="#cb4-33"></a>  quantity_column, price_column,</span>
<span id="cb4-34"><a href="#cb4-34"></a>  demand_specification, <span class="kw">paste0</span>(price_column, <span class="st">&quot; + &quot;</span>, supply_specification),</span>
<span id="cb4-35"><a href="#cb4-35"></a>  eq_data,</span>
<span id="cb4-36"><a href="#cb4-36"></a>  <span class="dt">use_correlated_shocks =</span> use_correlated_shocks, <span class="dt">verbose =</span> verbose</span>
<span id="cb4-37"><a href="#cb4-37"></a>)</span>
<span id="cb4-38"><a href="#cb4-38"></a><span class="co">#&gt; Info: This is &#39;Deterministic Adjustment with correlated shocks&#39; model</span></span>
<span id="cb4-39"><a href="#cb4-39"></a><span class="co">#&gt; Info: Dropping 5000 rows by generating &#39;LAGGED_P&#39;.</span></span>
<span id="cb4-40"><a href="#cb4-40"></a><span class="co">#&gt; Info: Sample separated with 10003 rows in excess supply and 9997 in excess demand regime.</span></span></code></pre></div>
</div>
<div id="estimation" class="section level2">
<h2>Estimation</h2>
<p>Set the estimation parameters.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>optimization_method &lt;-<span class="st"> &quot;BFGS&quot;</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>optimization_controls &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">maxit =</span> <span class="dv">10000</span>, <span class="dt">reltol =</span> <span class="fl">1e-8</span>)</span></code></pre></div>
<p>Estimate the models.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>eqmdl_reg &lt;-<span class="st"> </span><span class="kw">estimate</span>(eqmdl, <span class="dt">method =</span> <span class="st">&quot;2SLS&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>eqmdl_est &lt;-<span class="st"> </span><span class="kw">estimate</span>(eqmdl,</span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="dt">control =</span> optimization_controls,</span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="dt">method =</span> optimization_method</span>
<span id="cb6-5"><a href="#cb6-5"></a>)</span>
<span id="cb6-6"><a href="#cb6-6"></a>bsmdl_est &lt;-<span class="st"> </span><span class="kw">estimate</span>(bsmdl,</span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="dt">control =</span> optimization_controls,</span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="dt">method =</span> optimization_method</span>
<span id="cb6-9"><a href="#cb6-9"></a>)</span>
<span id="cb6-10"><a href="#cb6-10"></a>damdl_est &lt;-<span class="st"> </span><span class="kw">estimate</span>(damdl,</span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="dt">control =</span> optimization_controls,</span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="dt">method =</span> optimization_method</span>
<span id="cb6-13"><a href="#cb6-13"></a>)</span></code></pre></div>
</div>
<div id="post-estimation-analysis" class="section level2">
<h2>Post estimation analysis</h2>
<div id="summaries" class="section level3">
<h3>Summaries</h3>
<p>All the models provide estimates for the simulated data. Even with simulated data, it is difficult to assess which model performs better by examining only the summaries in separation or collectively.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">summary</span>(eqmdl_reg<span class="op">$</span>first_stage_model)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt; </span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; Call:</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt; lm(formula = first_stage_formula, data = object@model_tibble)</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt; </span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt; -0.85453 -0.14407  0.00004  0.14368  0.78798 </span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt; </span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">#&gt; (Intercept)  0.761849   0.017106   44.54   &lt;2e-16 ***</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt; Xd1          0.448077   0.003055  146.68   &lt;2e-16 ***</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt; Xd2         -0.144864   0.003056  -47.41   &lt;2e-16 ***</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt; X1           0.505181   0.003026  166.92   &lt;2e-16 ***</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#&gt; X2           0.437596   0.003072  142.44   &lt;2e-16 ***</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">#&gt; Xs1         -0.139496   0.003057  -45.63   &lt;2e-16 ***</span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#&gt; </span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#&gt; Residual standard error: 0.215 on 19994 degrees of freedom</span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">#&gt; Multiple R-squared:  0.7873, Adjusted R-squared:  0.7873 </span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">#&gt; F-statistic: 1.48e+04 on 5 and 19994 DF,  p-value: &lt; 2.2e-16</span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="kw">summary</span>(eqmdl_reg<span class="op">$</span>system_model)</span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="co">#&gt; </span></span>
<span id="cb7-26"><a href="#cb7-26"></a><span class="co">#&gt; systemfit results </span></span>
<span id="cb7-27"><a href="#cb7-27"></a><span class="co">#&gt; method: 2SLS </span></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="co">#&gt; </span></span>
<span id="cb7-29"><a href="#cb7-29"></a><span class="co">#&gt;            N    DF     SSR  detRCov   OLS-R2 McElroy-R2</span></span>
<span id="cb7-30"><a href="#cb7-30"></a><span class="co">#&gt; system 40000 39989 39903.8 0.736073 0.899874   0.848746</span></span>
<span id="cb7-31"><a href="#cb7-31"></a><span class="co">#&gt; </span></span>
<span id="cb7-32"><a href="#cb7-32"></a><span class="co">#&gt;            N    DF     SSR      MSE     RMSE       R2   Adj R2</span></span>
<span id="cb7-33"><a href="#cb7-33"></a><span class="co">#&gt; demand 20000 19994 20008.0 1.000702 1.000351 0.899592 0.899567</span></span>
<span id="cb7-34"><a href="#cb7-34"></a><span class="co">#&gt; supply 20000 19995 19895.7 0.995036 0.997515 0.900156 0.900136</span></span>
<span id="cb7-35"><a href="#cb7-35"></a><span class="co">#&gt; </span></span>
<span id="cb7-36"><a href="#cb7-36"></a><span class="co">#&gt; The covariance matrix of the residuals</span></span>
<span id="cb7-37"><a href="#cb7-37"></a><span class="co">#&gt;         demand   supply</span></span>
<span id="cb7-38"><a href="#cb7-38"></a><span class="co">#&gt; demand 1.00070 0.509570</span></span>
<span id="cb7-39"><a href="#cb7-39"></a><span class="co">#&gt; supply 0.50957 0.995036</span></span>
<span id="cb7-40"><a href="#cb7-40"></a><span class="co">#&gt; </span></span>
<span id="cb7-41"><a href="#cb7-41"></a><span class="co">#&gt; The correlations of the residuals</span></span>
<span id="cb7-42"><a href="#cb7-42"></a><span class="co">#&gt;          demand   supply</span></span>
<span id="cb7-43"><a href="#cb7-43"></a><span class="co">#&gt; demand 1.000000 0.510661</span></span>
<span id="cb7-44"><a href="#cb7-44"></a><span class="co">#&gt; supply 0.510661 1.000000</span></span>
<span id="cb7-45"><a href="#cb7-45"></a><span class="co">#&gt; </span></span>
<span id="cb7-46"><a href="#cb7-46"></a><span class="co">#&gt; </span></span>
<span id="cb7-47"><a href="#cb7-47"></a><span class="co">#&gt; 2SLS estimates for &#39;demand&#39; (equation 1)</span></span>
<span id="cb7-48"><a href="#cb7-48"></a><span class="co">#&gt; Model Formula: Q ~ P + Xd1 + Xd2 + X1 + X2</span></span>
<span id="cb7-49"><a href="#cb7-49"></a><span class="co">#&gt; &lt;environment: 0x557c5b59acc8&gt;</span></span>
<span id="cb7-50"><a href="#cb7-50"></a><span class="co">#&gt; Instruments: ~Xd1 + Xd2 + X1 + X2 + Xs1</span></span>
<span id="cb7-51"><a href="#cb7-51"></a><span class="co">#&gt; &lt;environment: 0x557c5b59acc8&gt;</span></span>
<span id="cb7-52"><a href="#cb7-52"></a><span class="co">#&gt; </span></span>
<span id="cb7-53"><a href="#cb7-53"></a><span class="co">#&gt;               Estimate Std. Error  t value   Pr(&gt;|t|)    </span></span>
<span id="cb7-54"><a href="#cb7-54"></a><span class="co">#&gt; (Intercept)  4.8762033  0.0827412  58.9332 &lt; 2.22e-16 ***</span></span>
<span id="cb7-55"><a href="#cb7-55"></a><span class="co">#&gt; P           -1.8442136  0.1019472 -18.0899 &lt; 2.22e-16 ***</span></span>
<span id="cb7-56"><a href="#cb7-56"></a><span class="co">#&gt; Xd1          2.0524139  0.0478747  42.8705 &lt; 2.22e-16 ***</span></span>
<span id="cb7-57"><a href="#cb7-57"></a><span class="co">#&gt; Xd2         -0.6858288  0.0205565 -33.3632 &lt; 2.22e-16 ***</span></span>
<span id="cb7-58"><a href="#cb7-58"></a><span class="co">#&gt; X1           3.5025023  0.0534337  65.5486 &lt; 2.22e-16 ***</span></span>
<span id="cb7-59"><a href="#cb7-59"></a><span class="co">#&gt; X2           6.2117062  0.0468246 132.6589 &lt; 2.22e-16 ***</span></span>
<span id="cb7-60"><a href="#cb7-60"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-61"><a href="#cb7-61"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-62"><a href="#cb7-62"></a><span class="co">#&gt; </span></span>
<span id="cb7-63"><a href="#cb7-63"></a><span class="co">#&gt; Residual standard error: 1.000351 on 19994 degrees of freedom</span></span>
<span id="cb7-64"><a href="#cb7-64"></a><span class="co">#&gt; Number of observations: 20000 Degrees of Freedom: 19994 </span></span>
<span id="cb7-65"><a href="#cb7-65"></a><span class="co">#&gt; SSR: 20008.043378 MSE: 1.000702 Root MSE: 1.000351 </span></span>
<span id="cb7-66"><a href="#cb7-66"></a><span class="co">#&gt; Multiple R-Squared: 0.899592 Adjusted R-Squared: 0.899567 </span></span>
<span id="cb7-67"><a href="#cb7-67"></a><span class="co">#&gt; </span></span>
<span id="cb7-68"><a href="#cb7-68"></a><span class="co">#&gt; </span></span>
<span id="cb7-69"><a href="#cb7-69"></a><span class="co">#&gt; 2SLS estimates for &#39;supply&#39; (equation 2)</span></span>
<span id="cb7-70"><a href="#cb7-70"></a><span class="co">#&gt; Model Formula: Q ~ P + Xs1 + X1 + X2</span></span>
<span id="cb7-71"><a href="#cb7-71"></a><span class="co">#&gt; &lt;environment: 0x557c5b59acc8&gt;</span></span>
<span id="cb7-72"><a href="#cb7-72"></a><span class="co">#&gt; Instruments: ~Xd1 + Xd2 + X1 + X2 + Xs1</span></span>
<span id="cb7-73"><a href="#cb7-73"></a><span class="co">#&gt; &lt;environment: 0x557c5b59acc8&gt;</span></span>
<span id="cb7-74"><a href="#cb7-74"></a><span class="co">#&gt; </span></span>
<span id="cb7-75"><a href="#cb7-75"></a><span class="co">#&gt;              Estimate Std. Error  t value   Pr(&gt;|t|)    </span></span>
<span id="cb7-76"><a href="#cb7-76"></a><span class="co">#&gt; (Intercept) 1.3095281  0.0768882  17.0316 &lt; 2.22e-16 ***</span></span>
<span id="cb7-77"><a href="#cb7-77"></a><span class="co">#&gt; P           2.7509924  0.0300520  91.5410 &lt; 2.22e-16 ***</span></span>
<span id="cb7-78"><a href="#cb7-78"></a><span class="co">#&gt; Xs1         0.6409146  0.0148046  43.2914 &lt; 2.22e-16 ***</span></span>
<span id="cb7-79"><a href="#cb7-79"></a><span class="co">#&gt; X1          1.1808148  0.0207026  57.0370 &lt; 2.22e-16 ***</span></span>
<span id="cb7-80"><a href="#cb7-80"></a><span class="co">#&gt; X2          4.2008260  0.0194740 215.7143 &lt; 2.22e-16 ***</span></span>
<span id="cb7-81"><a href="#cb7-81"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-82"><a href="#cb7-82"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-83"><a href="#cb7-83"></a><span class="co">#&gt; </span></span>
<span id="cb7-84"><a href="#cb7-84"></a><span class="co">#&gt; Residual standard error: 0.997515 on 19995 degrees of freedom</span></span>
<span id="cb7-85"><a href="#cb7-85"></a><span class="co">#&gt; Number of observations: 20000 Degrees of Freedom: 19995 </span></span>
<span id="cb7-86"><a href="#cb7-86"></a><span class="co">#&gt; SSR: 19895.74173 MSE: 0.995036 Root MSE: 0.997515 </span></span>
<span id="cb7-87"><a href="#cb7-87"></a><span class="co">#&gt; Multiple R-Squared: 0.900156 Adjusted R-Squared: 0.900136</span></span>
<span id="cb7-88"><a href="#cb7-88"></a>bbmle<span class="op">::</span><span class="kw">summary</span>(eqmdl_est)</span>
<span id="cb7-89"><a href="#cb7-89"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb7-90"><a href="#cb7-90"></a><span class="co">#&gt; </span></span>
<span id="cb7-91"><a href="#cb7-91"></a><span class="co">#&gt; Call:</span></span>
<span id="cb7-92"><a href="#cb7-92"></a><span class="co">#&gt; `bbmle::mle2`(list(method = &quot;BFGS&quot;, control = list(maxit = 10000, </span></span>
<span id="cb7-93"><a href="#cb7-93"></a><span class="co">#&gt;     reltol = 1e-08), skip.hessian = FALSE, start = c(D_P = 0.248904000229706, </span></span>
<span id="cb7-94"><a href="#cb7-94"></a><span class="co">#&gt; D_CONST = 4.01094480918336, D_Xd1 = 1.1137756892884, D_Xd2 = -0.380925520464488, </span></span>
<span id="cb7-95"><a href="#cb7-95"></a><span class="co">#&gt; D_X1 = 2.44419761908979, D_X2 = 5.29620369779804, S_P = 1.70876661459514, </span></span>
<span id="cb7-96"><a href="#cb7-96"></a><span class="co">#&gt; S_CONST = 2.885697667298, S_Xs1 = 0.493421828653425, S_X1 = 1.70854379946901, </span></span>
<span id="cb7-97"><a href="#cb7-97"></a><span class="co">#&gt; S_X2 = 4.66113245104969, D_VARIANCE = 1, S_VARIANCE = 1, RHO = 0</span></span>
<span id="cb7-98"><a href="#cb7-98"></a><span class="co">#&gt; ), minuslogl = function (...) </span></span>
<span id="cb7-99"><a href="#cb7-99"></a><span class="co">#&gt; minus_log_likelihood(object, ...), gr = function (...) </span></span>
<span id="cb7-100"><a href="#cb7-100"></a><span class="co">#&gt; gradient(object, ...)))</span></span>
<span id="cb7-101"><a href="#cb7-101"></a><span class="co">#&gt; </span></span>
<span id="cb7-102"><a href="#cb7-102"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb7-103"><a href="#cb7-103"></a><span class="co">#&gt;             Estimate Std. Error z value     Pr(z)    </span></span>
<span id="cb7-104"><a href="#cb7-104"></a><span class="co">#&gt; D_P        -1.847620   0.102162 -18.085 &lt; 2.2e-16 ***</span></span>
<span id="cb7-105"><a href="#cb7-105"></a><span class="co">#&gt; D_CONST     4.845601   0.079952  60.606 &lt; 2.2e-16 ***</span></span>
<span id="cb7-106"><a href="#cb7-106"></a><span class="co">#&gt; D_Xd1       2.057105   0.047842  42.998 &lt; 2.2e-16 ***</span></span>
<span id="cb7-107"><a href="#cb7-107"></a><span class="co">#&gt; D_Xd2      -0.676054   0.019563 -34.558 &lt; 2.2e-16 ***</span></span>
<span id="cb7-108"><a href="#cb7-108"></a><span class="co">#&gt; D_X1        3.503609   0.053540  65.439 &lt; 2.2e-16 ***</span></span>
<span id="cb7-109"><a href="#cb7-109"></a><span class="co">#&gt; D_X2        6.213180   0.046915 132.435 &lt; 2.2e-16 ***</span></span>
<span id="cb7-110"><a href="#cb7-110"></a><span class="co">#&gt; S_P         2.750472   0.030038  91.567 &lt; 2.2e-16 ***</span></span>
<span id="cb7-111"><a href="#cb7-111"></a><span class="co">#&gt; S_CONST     1.311502   0.076848  17.066 &lt; 2.2e-16 ***</span></span>
<span id="cb7-112"><a href="#cb7-112"></a><span class="co">#&gt; S_Xs1       0.640863   0.014796  43.313 &lt; 2.2e-16 ***</span></span>
<span id="cb7-113"><a href="#cb7-113"></a><span class="co">#&gt; S_X1        1.180568   0.020695  57.045 &lt; 2.2e-16 ***</span></span>
<span id="cb7-114"><a href="#cb7-114"></a><span class="co">#&gt; S_X2        4.201078   0.019466 215.811 &lt; 2.2e-16 ***</span></span>
<span id="cb7-115"><a href="#cb7-115"></a><span class="co">#&gt; D_VARIANCE  1.001167   0.024052  41.625 &lt; 2.2e-16 ***</span></span>
<span id="cb7-116"><a href="#cb7-116"></a><span class="co">#&gt; S_VARIANCE  0.994439   0.011789  84.353 &lt; 2.2e-16 ***</span></span>
<span id="cb7-117"><a href="#cb7-117"></a><span class="co">#&gt; RHO         0.510389   0.017863  28.572 &lt; 2.2e-16 ***</span></span>
<span id="cb7-118"><a href="#cb7-118"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-119"><a href="#cb7-119"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-120"><a href="#cb7-120"></a><span class="co">#&gt; </span></span>
<span id="cb7-121"><a href="#cb7-121"></a><span class="co">#&gt; -2 log L: 46374.23</span></span>
<span id="cb7-122"><a href="#cb7-122"></a>bbmle<span class="op">::</span><span class="kw">summary</span>(bsmdl_est)</span>
<span id="cb7-123"><a href="#cb7-123"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb7-124"><a href="#cb7-124"></a><span class="co">#&gt; </span></span>
<span id="cb7-125"><a href="#cb7-125"></a><span class="co">#&gt; Call:</span></span>
<span id="cb7-126"><a href="#cb7-126"></a><span class="co">#&gt; `bbmle::mle2`(list(control = list(maxit = 10000, reltol = 1e-08), </span></span>
<span id="cb7-127"><a href="#cb7-127"></a><span class="co">#&gt;     method = &quot;BFGS&quot;, skip.hessian = FALSE, start = c(D_P = 0.248904000229706, </span></span>
<span id="cb7-128"><a href="#cb7-128"></a><span class="co">#&gt;     D_CONST = 4.01094480918336, D_Xd1 = 1.1137756892884, D_Xd2 = -0.380925520464488, </span></span>
<span id="cb7-129"><a href="#cb7-129"></a><span class="co">#&gt;     D_X1 = 2.44419761908979, D_X2 = 5.29620369779804, S_P = 1.70876661459514, </span></span>
<span id="cb7-130"><a href="#cb7-130"></a><span class="co">#&gt;     S_CONST = 2.885697667298, S_Xs1 = 0.493421828653425, S_X1 = 1.70854379946901, </span></span>
<span id="cb7-131"><a href="#cb7-131"></a><span class="co">#&gt;     S_X2 = 4.66113245104969, D_VARIANCE = 1, S_VARIANCE = 1, </span></span>
<span id="cb7-132"><a href="#cb7-132"></a><span class="co">#&gt;     RHO = 0), minuslogl = function (...) </span></span>
<span id="cb7-133"><a href="#cb7-133"></a><span class="co">#&gt;     minus_log_likelihood(object, ...), gr = function (...) </span></span>
<span id="cb7-134"><a href="#cb7-134"></a><span class="co">#&gt;     gradient(object, ...)))</span></span>
<span id="cb7-135"><a href="#cb7-135"></a><span class="co">#&gt; </span></span>
<span id="cb7-136"><a href="#cb7-136"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb7-137"><a href="#cb7-137"></a><span class="co">#&gt;             Estimate Std. Error  z value     Pr(z)    </span></span>
<span id="cb7-138"><a href="#cb7-138"></a><span class="co">#&gt; D_P         0.049812   0.053832   0.9253 0.3548000    </span></span>
<span id="cb7-139"><a href="#cb7-139"></a><span class="co">#&gt; D_CONST     4.014641   0.115685  34.7033 &lt; 2.2e-16 ***</span></span>
<span id="cb7-140"><a href="#cb7-140"></a><span class="co">#&gt; D_Xd1       1.322024   0.036993  35.7369 &lt; 2.2e-16 ***</span></span>
<span id="cb7-141"><a href="#cb7-141"></a><span class="co">#&gt; D_Xd2      -0.455326   0.019782 -23.0177 &lt; 2.2e-16 ***</span></span>
<span id="cb7-142"><a href="#cb7-142"></a><span class="co">#&gt; D_X1        2.577838   0.037536  68.6762 &lt; 2.2e-16 ***</span></span>
<span id="cb7-143"><a href="#cb7-143"></a><span class="co">#&gt; D_X2        5.390141   0.034642 155.5962 &lt; 2.2e-16 ***</span></span>
<span id="cb7-144"><a href="#cb7-144"></a><span class="co">#&gt; S_P         1.761937   0.105878  16.6412 &lt; 2.2e-16 ***</span></span>
<span id="cb7-145"><a href="#cb7-145"></a><span class="co">#&gt; S_CONST     2.836331   0.359832   7.8824 3.212e-15 ***</span></span>
<span id="cb7-146"><a href="#cb7-146"></a><span class="co">#&gt; S_Xs1       1.119391   0.086554  12.9329 &lt; 2.2e-16 ***</span></span>
<span id="cb7-147"><a href="#cb7-147"></a><span class="co">#&gt; S_X1        1.575385   0.091235  17.2674 &lt; 2.2e-16 ***</span></span>
<span id="cb7-148"><a href="#cb7-148"></a><span class="co">#&gt; S_X2        4.613717   0.082291  56.0662 &lt; 2.2e-16 ***</span></span>
<span id="cb7-149"><a href="#cb7-149"></a><span class="co">#&gt; D_VARIANCE  0.822471   0.017428  47.1932 &lt; 2.2e-16 ***</span></span>
<span id="cb7-150"><a href="#cb7-150"></a><span class="co">#&gt; S_VARIANCE  1.372021   0.090718  15.1240 &lt; 2.2e-16 ***</span></span>
<span id="cb7-151"><a href="#cb7-151"></a><span class="co">#&gt; RHO         0.204999   0.056839   3.6066 0.0003102 ***</span></span>
<span id="cb7-152"><a href="#cb7-152"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-153"><a href="#cb7-153"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-154"><a href="#cb7-154"></a><span class="co">#&gt; </span></span>
<span id="cb7-155"><a href="#cb7-155"></a><span class="co">#&gt; -2 log L: 51245.47</span></span>
<span id="cb7-156"><a href="#cb7-156"></a>bbmle<span class="op">::</span><span class="kw">summary</span>(damdl_est)</span>
<span id="cb7-157"><a href="#cb7-157"></a><span class="co">#&gt; Maximum likelihood estimation</span></span>
<span id="cb7-158"><a href="#cb7-158"></a><span class="co">#&gt; </span></span>
<span id="cb7-159"><a href="#cb7-159"></a><span class="co">#&gt; Call:</span></span>
<span id="cb7-160"><a href="#cb7-160"></a><span class="co">#&gt; `bbmle::mle2`(list(control = list(maxit = 10000, reltol = 1e-08), </span></span>
<span id="cb7-161"><a href="#cb7-161"></a><span class="co">#&gt;     method = &quot;BFGS&quot;, skip.hessian = FALSE, start = c(D_P = 0.248904000229706, </span></span>
<span id="cb7-162"><a href="#cb7-162"></a><span class="co">#&gt;     D_CONST = 4.01094480918336, D_Xd1 = 1.1137756892884, D_Xd2 = -0.380925520464488, </span></span>
<span id="cb7-163"><a href="#cb7-163"></a><span class="co">#&gt;     D_X1 = 2.44419761908979, D_X2 = 5.29620369779804, S_P = 1.70876661459514, </span></span>
<span id="cb7-164"><a href="#cb7-164"></a><span class="co">#&gt;     S_CONST = 2.885697667298, S_Xs1 = 0.493421828653425, S_X1 = 1.70854379946901, </span></span>
<span id="cb7-165"><a href="#cb7-165"></a><span class="co">#&gt;     S_X2 = 4.66113245104969, P_DIFF = 1, D_VARIANCE = 1, S_VARIANCE = 1, </span></span>
<span id="cb7-166"><a href="#cb7-166"></a><span class="co">#&gt;     RHO = 0), minuslogl = function (...) </span></span>
<span id="cb7-167"><a href="#cb7-167"></a><span class="co">#&gt;     minus_log_likelihood(object, ...), gr = function (...) </span></span>
<span id="cb7-168"><a href="#cb7-168"></a><span class="co">#&gt;     gradient(object, ...)))</span></span>
<span id="cb7-169"><a href="#cb7-169"></a><span class="co">#&gt; </span></span>
<span id="cb7-170"><a href="#cb7-170"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb7-171"><a href="#cb7-171"></a><span class="co">#&gt;             Estimate Std. Error  z value  Pr(z)    </span></span>
<span id="cb7-172"><a href="#cb7-172"></a><span class="co">#&gt; D_P        -1.849202   0.102147 -18.1034 &lt;2e-16 ***</span></span>
<span id="cb7-173"><a href="#cb7-173"></a><span class="co">#&gt; D_CONST     4.860420   0.082592  58.8486 &lt;2e-16 ***</span></span>
<span id="cb7-174"><a href="#cb7-174"></a><span class="co">#&gt; D_Xd1       2.054982   0.047717  43.0664 &lt;2e-16 ***</span></span>
<span id="cb7-175"><a href="#cb7-175"></a><span class="co">#&gt; D_Xd2      -0.675406   0.019519 -34.6019 &lt;2e-16 ***</span></span>
<span id="cb7-176"><a href="#cb7-176"></a><span class="co">#&gt; D_X1        3.501842   0.053401  65.5767 &lt;2e-16 ***</span></span>
<span id="cb7-177"><a href="#cb7-177"></a><span class="co">#&gt; D_X2        6.211275   0.046794 132.7369 &lt;2e-16 ***</span></span>
<span id="cb7-178"><a href="#cb7-178"></a><span class="co">#&gt; S_P         2.757014   0.030859  89.3424 &lt;2e-16 ***</span></span>
<span id="cb7-179"><a href="#cb7-179"></a><span class="co">#&gt; S_CONST     1.284230   0.081551  15.7476 &lt;2e-16 ***</span></span>
<span id="cb7-180"><a href="#cb7-180"></a><span class="co">#&gt; S_Xs1       0.640862   0.014799  43.3037 &lt;2e-16 ***</span></span>
<span id="cb7-181"><a href="#cb7-181"></a><span class="co">#&gt; S_X1        1.181013   0.020696  57.0636 &lt;2e-16 ***</span></span>
<span id="cb7-182"><a href="#cb7-182"></a><span class="co">#&gt; S_X2        4.200912   0.019469 215.7692 &lt;2e-16 ***</span></span>
<span id="cb7-183"><a href="#cb7-183"></a><span class="co">#&gt; P_DIFF     -0.013436   0.013574  -0.9898 0.3223    </span></span>
<span id="cb7-184"><a href="#cb7-184"></a><span class="co">#&gt; D_VARIANCE  0.999927   0.023931  41.7841 &lt;2e-16 ***</span></span>
<span id="cb7-185"><a href="#cb7-185"></a><span class="co">#&gt; S_VARIANCE  0.994434   0.011789  84.3560 &lt;2e-16 ***</span></span>
<span id="cb7-186"><a href="#cb7-186"></a><span class="co">#&gt; RHO         0.511222   0.017821  28.6869 &lt;2e-16 ***</span></span>
<span id="cb7-187"><a href="#cb7-187"></a><span class="co">#&gt; ---</span></span>
<span id="cb7-188"><a href="#cb7-188"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb7-189"><a href="#cb7-189"></a><span class="co">#&gt; </span></span>
<span id="cb7-190"><a href="#cb7-190"></a><span class="co">#&gt; -2 log L: 46373.32</span></span></code></pre></div>
</div>
<div id="model-selection" class="section level3">
<h3>Model selection</h3>
<p>The deterministic adjustment model has price dynamics that are analogous to excess demand and estimates one extra parameter. The directional model estimates one parameter less as the model does not have enough equations to identify prices in both demand and supply equations. The estimated parameters are summarized as follows.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>sim_coef &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb8-2"><a href="#cb8-2"></a>  alpha_d, beta_d0, beta_d, eta_d,</span>
<span id="cb8-3"><a href="#cb8-3"></a>  alpha_s, beta_s0, beta_s, eta_s,</span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="ot">NA</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>  sigma_d, sigma_s,</span>
<span id="cb8-6"><a href="#cb8-6"></a>  rho_ds</span>
<span id="cb8-7"><a href="#cb8-7"></a>)</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="kw">names</span>(sim_coef) &lt;-<span class="st"> </span><span class="kw">names</span>(damdl_est<span class="op">@</span>coef)</span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a>dm_inc &lt;-<span class="st"> </span>eqmdl_reg<span class="op">$</span>system_model<span class="op">$</span>coefficients[</span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="kw">grep</span>(</span>
<span id="cb8-12"><a href="#cb8-12"></a>    <span class="st">&quot;demand&quot;</span>,</span>
<span id="cb8-13"><a href="#cb8-13"></a>    <span class="kw">names</span>(eqmdl_reg<span class="op">$</span>system_model<span class="op">$</span>coefficients)</span>
<span id="cb8-14"><a href="#cb8-14"></a>  )</span>
<span id="cb8-15"><a href="#cb8-15"></a>]</span>
<span id="cb8-16"><a href="#cb8-16"></a>sp_inc &lt;-<span class="st"> </span>eqmdl_reg<span class="op">$</span>system_model<span class="op">$</span>coefficients[</span>
<span id="cb8-17"><a href="#cb8-17"></a>  <span class="kw">grep</span>(</span>
<span id="cb8-18"><a href="#cb8-18"></a>    <span class="st">&quot;supply&quot;</span>,</span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="kw">names</span>(eqmdl_reg<span class="op">$</span>system_model<span class="op">$</span>coefficients)</span>
<span id="cb8-20"><a href="#cb8-20"></a>  )</span>
<span id="cb8-21"><a href="#cb8-21"></a>]</span>
<span id="cb8-22"><a href="#cb8-22"></a>lm_coef &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb8-23"><a href="#cb8-23"></a>  dm_inc[<span class="dv">2</span>], dm_inc[<span class="op">-</span><span class="dv">2</span>], sp_inc[<span class="dv">2</span>], sp_inc[<span class="op">-</span><span class="dv">2</span>],</span>
<span id="cb8-24"><a href="#cb8-24"></a>  <span class="ot">NA</span>,</span>
<span id="cb8-25"><a href="#cb8-25"></a>  <span class="ot">NA</span>, <span class="ot">NA</span>,</span>
<span id="cb8-26"><a href="#cb8-26"></a>  <span class="ot">NA</span></span>
<span id="cb8-27"><a href="#cb8-27"></a>)</span>
<span id="cb8-28"><a href="#cb8-28"></a></span>
<span id="cb8-29"><a href="#cb8-29"></a>eqmdl_coef &lt;-<span class="st"> </span><span class="kw">append</span>(</span>
<span id="cb8-30"><a href="#cb8-30"></a>  eqmdl_est<span class="op">@</span>coef, <span class="kw">c</span>(<span class="ot">NA</span>),</span>
<span id="cb8-31"><a href="#cb8-31"></a>  <span class="dt">after =</span> <span class="kw">which</span>(<span class="kw">names</span>(eqmdl_est<span class="op">@</span>coef) <span class="op">==</span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="st">    </span><span class="kw">get_prefixed_variance_variable</span>(eqmdl<span class="op">@</span>system<span class="op">@</span>demand)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>)</span>
<span id="cb8-34"><a href="#cb8-34"></a></span>
<span id="cb8-35"><a href="#cb8-35"></a>bsmdl_coef &lt;-<span class="st"> </span><span class="kw">append</span>(</span>
<span id="cb8-36"><a href="#cb8-36"></a>  bsmdl_est<span class="op">@</span>coef, <span class="kw">c</span>(<span class="ot">NA</span>),</span>
<span id="cb8-37"><a href="#cb8-37"></a>  <span class="dt">after =</span> <span class="kw">which</span>(<span class="kw">names</span>(bsmdl_est<span class="op">@</span>coef) <span class="op">==</span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="st">    </span><span class="kw">get_prefixed_variance_variable</span>(bsmdl<span class="op">@</span>system<span class="op">@</span>demand)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb8-39"><a href="#cb8-39"></a>)</span>
<span id="cb8-40"><a href="#cb8-40"></a></span>
<span id="cb8-41"><a href="#cb8-41"></a>damdl_coef &lt;-<span class="st"> </span>damdl_est<span class="op">@</span>coef</span>
<span id="cb8-42"><a href="#cb8-42"></a></span>
<span id="cb8-43"><a href="#cb8-43"></a>comp &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</span>
<span id="cb8-44"><a href="#cb8-44"></a>  <span class="dt">parameter =</span> <span class="kw">names</span>(sim_coef),</span>
<span id="cb8-45"><a href="#cb8-45"></a>  <span class="dt">sim =</span> sim_coef, <span class="dt">lm =</span> lm_coef, <span class="dt">fi =</span> eqmdl_coef,</span>
<span id="cb8-46"><a href="#cb8-46"></a>  <span class="dt">bm =</span> bsmdl_coef, <span class="dt">da =</span> damdl_coef,</span>
<span id="cb8-47"><a href="#cb8-47"></a>  <span class="dt">lmerr =</span> <span class="kw">abs</span>(lm_coef <span class="op">-</span><span class="st"> </span>sim_coef), <span class="dt">fierr =</span> <span class="kw">abs</span>(eqmdl_coef <span class="op">-</span><span class="st"> </span>sim_coef),</span>
<span id="cb8-48"><a href="#cb8-48"></a>  <span class="dt">bmerr =</span> <span class="kw">abs</span>(bsmdl_coef <span class="op">-</span><span class="st"> </span>sim_coef), <span class="dt">daerr =</span> <span class="kw">abs</span>(damdl_coef <span class="op">-</span><span class="st"> </span>sim_coef)</span>
<span id="cb8-49"><a href="#cb8-49"></a>)</span>
<span id="cb8-50"><a href="#cb8-50"></a>comp</span>
<span id="cb8-51"><a href="#cb8-51"></a><span class="co">#&gt; # A tibble: 15 x 10</span></span>
<span id="cb8-52"><a href="#cb8-52"></a><span class="co">#&gt;    parameter   sim     lm     fi      bm      da    lmerr    fierr  bmerr</span></span>
<span id="cb8-53"><a href="#cb8-53"></a><span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb8-54"><a href="#cb8-54"></a><span class="co">#&gt;  1 D_P       -1.9  -1.84  -1.85   0.0498 -1.85    5.58e-2  0.0524   1.95 </span></span>
<span id="cb8-55"><a href="#cb8-55"></a><span class="co">#&gt;  2 D_CONST    4.9   4.88   4.85   4.01    4.86    2.38e-2  0.0544   0.885</span></span>
<span id="cb8-56"><a href="#cb8-56"></a><span class="co">#&gt;  3 D_Xd1      2.1   2.05   2.06   1.32    2.05    4.76e-2  0.0429   0.778</span></span>
<span id="cb8-57"><a href="#cb8-57"></a><span class="co">#&gt;  4 D_Xd2     -0.7  -0.686 -0.676 -0.455  -0.675   1.42e-2  0.0239   0.245</span></span>
<span id="cb8-58"><a href="#cb8-58"></a><span class="co">#&gt;  5 D_X1       3.5   3.50   3.50   2.58    3.50    2.50e-3  0.00361  0.922</span></span>
<span id="cb8-59"><a href="#cb8-59"></a><span class="co">#&gt;  6 D_X2       6.25  6.21   6.21   5.39    6.21    3.83e-2  0.0368   0.860</span></span>
<span id="cb8-60"><a href="#cb8-60"></a><span class="co">#&gt;  7 S_P        2.8   2.75   2.75   1.76    2.76    4.90e-2  0.0495   1.04 </span></span>
<span id="cb8-61"><a href="#cb8-61"></a><span class="co">#&gt;  8 S_CONST    1.2   1.31   1.31   2.84    1.28    1.10e-1  0.112    1.64 </span></span>
<span id="cb8-62"><a href="#cb8-62"></a><span class="co">#&gt;  9 S_Xs1      0.65  0.641  0.641  1.12    0.641   9.09e-3  0.00914  0.469</span></span>
<span id="cb8-63"><a href="#cb8-63"></a><span class="co">#&gt; 10 S_X1       1.15  1.18   1.18   1.58    1.18    3.08e-2  0.0306   0.425</span></span>
<span id="cb8-64"><a href="#cb8-64"></a><span class="co">#&gt; 11 S_X2       4.2   4.20   4.20   4.61    4.20    8.26e-4  0.00108  0.414</span></span>
<span id="cb8-65"><a href="#cb8-65"></a><span class="co">#&gt; 12 P_DIFF    NA    NA     NA     NA      -0.0134 NA       NA       NA    </span></span>
<span id="cb8-66"><a href="#cb8-66"></a><span class="co">#&gt; 13 D_VARIAN…  1    NA      1.00   0.822   1.00   NA        0.00117  0.178</span></span>
<span id="cb8-67"><a href="#cb8-67"></a><span class="co">#&gt; 14 S_VARIAN…  1    NA      0.994  1.37    0.994  NA        0.00556  0.372</span></span>
<span id="cb8-68"><a href="#cb8-68"></a><span class="co">#&gt; 15 RHO        0.5  NA      0.510  0.205   0.511  NA        0.0104   0.295</span></span>
<span id="cb8-69"><a href="#cb8-69"></a><span class="co">#&gt; # … with 1 more variable: daerr &lt;dbl&gt;</span></span></code></pre></div>
<p>Since we have used simulated data, we can calculate the average absolute error of the parameter estimation for each of the models. In practice, the population values are unknown and this calculation is impossible.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>comp_means &lt;-<span class="st"> </span><span class="kw">colMeans</span>(comp[, <span class="kw">grep</span>(<span class="st">&quot;err&quot;</span>, <span class="kw">colnames</span>(comp))], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>comp_means</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt;      lmerr      fierr      bmerr      daerr </span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">#&gt; 0.03467257 0.03092702 0.74766291 0.02754986</span></span></code></pre></div>
<p>Moreover, the average absolute error cannot provide an overall estimation assessment as the market models have different parameter spaces. To assess the overall model performance one can instead use an information criterion.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>model_names &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb10-2"><a href="#cb10-2"></a>  eqmdl<span class="op">@</span>model_type_string,</span>
<span id="cb10-3"><a href="#cb10-3"></a>  bsmdl<span class="op">@</span>model_type_string, damdl<span class="op">@</span>model_type_string</span>
<span id="cb10-4"><a href="#cb10-4"></a>)</span>
<span id="cb10-5"><a href="#cb10-5"></a>model_obs &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="kw">get_number_of_observations</span>(eqmdl),</span>
<span id="cb10-7"><a href="#cb10-7"></a>  <span class="kw">get_number_of_observations</span>(bsmdl),</span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="kw">get_number_of_observations</span>(damdl)</span>
<span id="cb10-9"><a href="#cb10-9"></a>)</span>
<span id="cb10-10"><a href="#cb10-10"></a>model_errors &lt;-<span class="st"> </span><span class="kw">c</span>(</span>
<span id="cb10-11"><a href="#cb10-11"></a>  comp_means[<span class="st">&quot;fierr&quot;</span>],</span>
<span id="cb10-12"><a href="#cb10-12"></a>  comp_means[<span class="st">&quot;bmerr&quot;</span>],</span>
<span id="cb10-13"><a href="#cb10-13"></a>  comp_means[<span class="st">&quot;daerr&quot;</span>]</span>
<span id="cb10-14"><a href="#cb10-14"></a>)</span>
<span id="cb10-15"><a href="#cb10-15"></a>seltbl &lt;-<span class="st"> </span><span class="kw">AIC</span>(eqmdl_est, bsmdl_est, damdl_est) <span class="op">%&gt;%</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="st">  </span>tibble<span class="op">::</span><span class="kw">add_column</span>(<span class="dt">Model =</span> model_names, <span class="dt">.before =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="st">  </span>tibble<span class="op">::</span><span class="kw">add_column</span>(<span class="dt">Obs. =</span> model_obs, <span class="st">`</span><span class="dt">Mean Error</span><span class="st">`</span> =<span class="st"> </span>model_errors) <span class="op">%&gt;%</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">D.F. =</span> df) <span class="op">%&gt;%</span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(AIC)</span>
<span id="cb10-20"><a href="#cb10-20"></a>seltbl</span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co">#&gt;                              Model D.F.      AIC  Obs. Mean Error</span></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="co">#&gt; eqmdl_est         Equilibrium FIML   14 46402.23 20000 0.03092702</span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co">#&gt; damdl_est Deterministic Adjustment   15 46403.32 20000 0.02754986</span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co">#&gt; bsmdl_est                    Basic   14 51273.47 20000 0.74766291</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
