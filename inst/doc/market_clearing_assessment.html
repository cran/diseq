<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>An example of market-clearing assessment</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">An example of market-clearing assessment</h1>



<p>This short tutorial gives an example of how one can statistically assess whether a market is in an equilibrium state. The tutorial assumes some familiarity with the concepts and the functionality of the package. The <a href="basic_usage.html">basic_usage</a> vignette can be helpful in acquiring this familiarity.</p>
<div id="setup-the-environment" class="section level2">
<h2>Setup the environment</h2>
<p>Load the required libraries.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(diseq)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(magrittr)</a></code></pre></div>
<p>Prepare the data. Here, we simply simulate data using a data generating process for a market in equilibrium.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">nobs &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb2-2" title="2">tobs &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4">alpha_d &lt;-<span class="st"> </span><span class="fl">-3.9</span></a>
<a class="sourceLine" id="cb2-5" title="5">beta_d0 &lt;-<span class="st"> </span><span class="fl">18.9</span></a>
<a class="sourceLine" id="cb2-6" title="6">beta_d &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.1</span>, <span class="fl">-0.7</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">eta_d &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">6.25</span>)</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9">alpha_s &lt;-<span class="st"> </span><span class="fl">2.8</span></a>
<a class="sourceLine" id="cb2-10" title="10">beta_s0 &lt;-<span class="st"> </span><span class="fl">3.2</span></a>
<a class="sourceLine" id="cb2-11" title="11">beta_s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.65</span>)</a>
<a class="sourceLine" id="cb2-12" title="12">eta_s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.15</span>, <span class="fl">4.2</span>)</a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14">sigma_d &lt;-<span class="st"> </span><span class="fl">0.8</span></a>
<a class="sourceLine" id="cb2-15" title="15">sigma_s &lt;-<span class="st"> </span><span class="fl">1.1</span></a>
<a class="sourceLine" id="cb2-16" title="16">rho_ds &lt;-<span class="st"> </span><span class="fl">0.0</span></a>
<a class="sourceLine" id="cb2-17" title="17"></a>
<a class="sourceLine" id="cb2-18" title="18">seed &lt;-<span class="st"> </span><span class="dv">42</span></a>
<a class="sourceLine" id="cb2-19" title="19"></a>
<a class="sourceLine" id="cb2-20" title="20">eq_data &lt;-<span class="st"> </span><span class="kw">simulate_data</span>(</a>
<a class="sourceLine" id="cb2-21" title="21">  <span class="st">&quot;equilibrium_model&quot;</span>, nobs, tobs,</a>
<a class="sourceLine" id="cb2-22" title="22">  alpha_d, beta_d0, beta_d, eta_d,</a>
<a class="sourceLine" id="cb2-23" title="23">  alpha_s, beta_s0, beta_s, eta_s,</a>
<a class="sourceLine" id="cb2-24" title="24">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="kw">c</span>(<span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb2-25" title="25">  <span class="dt">sigma_d =</span> sigma_d, <span class="dt">sigma_s =</span> sigma_s, <span class="dt">rho_ds =</span> rho_ds,</a>
<a class="sourceLine" id="cb2-26" title="26">  <span class="dt">seed =</span> seed</a>
<a class="sourceLine" id="cb2-27" title="27">)</a></code></pre></div>
</div>
<div id="estimate-the-models" class="section level2">
<h2>Estimate the models</h2>
<p>Prepare the basic parameters for model initialization.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">verbose &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb3-2" title="2">correlated_shocks &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb3-3" title="3">formula &lt;-<span class="st">   </span>Q <span class="op">|</span><span class="st"> </span>P <span class="op">|</span><span class="st"> </span>id <span class="op">|</span><span class="st"> </span>date <span class="op">~</span><span class="st"> </span>P <span class="op">+</span><span class="st"> </span>Xd1 <span class="op">+</span><span class="st"> </span>Xd2 <span class="op">+</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2 <span class="op">|</span><span class="st"> </span>P <span class="op">+</span><span class="st"> </span>Xs1 <span class="op">+</span><span class="st"> </span>X1 <span class="op">+</span><span class="st"> </span>X2</a></code></pre></div>
<p>Set the estimation parameters.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">optimization_method &lt;-<span class="st"> &quot;BFGS&quot;</span></a>
<a class="sourceLine" id="cb4-2" title="2">optimization_options &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">maxit =</span> <span class="dv">10000</span>, <span class="dt">reltol =</span> <span class="fl">1e-8</span>)</a></code></pre></div>
<p>Using the above parameterization, construct and estimate the model objects. Here we estimate two equilibrium models and four disequilibrium models. All the models are constructed using the simulated data from a model of market in equilibrium.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">eqmdl_reg &lt;-<span class="st"> </span><span class="kw">equilibrium_model</span>(</a>
<a class="sourceLine" id="cb5-2" title="2">  formula, eq_data[eq_data<span class="op">$</span>date <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="dt">correlated_shocks =</span> correlated_shocks, <span class="dt">verbose =</span> verbose,</a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="dt">estimation_options =</span> <span class="kw">list</span>(<span class="dt">method =</span> <span class="st">&quot;2SLS&quot;</span>)</a>
<a class="sourceLine" id="cb5-5" title="5">)</a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#&gt; Info: This is &#39;Equilibrium with correlated shocks&#39; model</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co">#&gt; Warning: Removing unobserved &#39;1&#39; level(s).</span></a>
<a class="sourceLine" id="cb5-8" title="8">eqmdl_fit &lt;-<span class="st"> </span><span class="kw">equilibrium_model</span>(</a>
<a class="sourceLine" id="cb5-9" title="9">  formula, eq_data[eq_data<span class="op">$</span>date <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb5-10" title="10">  <span class="dt">correlated_shocks =</span> correlated_shocks, <span class="dt">verbose =</span> verbose,</a>
<a class="sourceLine" id="cb5-11" title="11">  <span class="dt">estimation_options =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb5-12" title="12">    <span class="dt">control =</span> optimization_options, <span class="dt">method =</span> optimization_method</a>
<a class="sourceLine" id="cb5-13" title="13">  )</a>
<a class="sourceLine" id="cb5-14" title="14">)</a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt; Info: This is &#39;Equilibrium with correlated shocks&#39; model</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt; Warning: Removing unobserved &#39;1&#39; level(s).</span></a>
<a class="sourceLine" id="cb5-17" title="17">bsmdl_fit &lt;-<span class="st"> </span><span class="kw">diseq_basic</span>(</a>
<a class="sourceLine" id="cb5-18" title="18">  formula, eq_data[eq_data<span class="op">$</span>date <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb5-19" title="19">  <span class="dt">correlated_shocks =</span> correlated_shocks, <span class="dt">verbose =</span> verbose,</a>
<a class="sourceLine" id="cb5-20" title="20">  <span class="dt">estimation_options =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb5-21" title="21">    <span class="dt">control =</span> optimization_options, <span class="dt">method =</span> optimization_method</a>
<a class="sourceLine" id="cb5-22" title="22">  )</a>
<a class="sourceLine" id="cb5-23" title="23">)</a>
<a class="sourceLine" id="cb5-24" title="24"><span class="co">#&gt; Info: This is &#39;Basic with correlated shocks&#39; model</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="co">#&gt; Warning: Removing unobserved &#39;1&#39; level(s).</span></a>
<a class="sourceLine" id="cb5-26" title="26">damdl_fit &lt;-<span class="st"> </span><span class="kw">diseq_deterministic_adjustment</span>(</a>
<a class="sourceLine" id="cb5-27" title="27">  formula, eq_data,</a>
<a class="sourceLine" id="cb5-28" title="28">  <span class="dt">correlated_shocks =</span> correlated_shocks, <span class="dt">verbose =</span> verbose,</a>
<a class="sourceLine" id="cb5-29" title="29">  <span class="dt">estimation_options =</span> <span class="kw">list</span>(</a>
<a class="sourceLine" id="cb5-30" title="30">    <span class="dt">control =</span> optimization_options, <span class="dt">method =</span> optimization_method</a>
<a class="sourceLine" id="cb5-31" title="31">  )</a>
<a class="sourceLine" id="cb5-32" title="32">)</a>
<a class="sourceLine" id="cb5-33" title="33"><span class="co">#&gt; Info: This is &#39;Deterministic Adjustment with correlated shocks&#39; model</span></a>
<a class="sourceLine" id="cb5-34" title="34"><span class="co">#&gt; Info: Dropping 1000 rows by generating &#39;LAGGED_P&#39;.</span></a>
<a class="sourceLine" id="cb5-35" title="35"><span class="co">#&gt; Info: Sample separated with 1971 rows in excess supply and 2029 in excess demand state.</span></a></code></pre></div>
</div>
<div id="post-estimation-analysis" class="section level2">
<h2>Post estimation analysis</h2>
<div id="summaries" class="section level3">
<h3>Summaries</h3>
<p>All the models provide estimates for the simulated data. Even with simulated data, it is difficult to assess which model performs better by examining only the summaries in separation or collectively.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">summary</span>(eqmdl_reg<span class="op">@</span>fit[[<span class="dv">1</span>]]<span class="op">$</span>first_stage_model)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; lm(formula = first_stage_formula, data = object@model_tibble)</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; Residuals:</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; -0.88388 -0.14215  0.00305  0.14088  0.81967 </span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; (Intercept)  2.356218   0.036603   64.37   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt; Xd1          0.314532   0.006576   47.83   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt; Xd2         -0.102046   0.006549  -15.58   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; X1           0.347118   0.006523   53.21   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="co">#&gt; X2           0.306744   0.006445   47.60   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-17" title="17"><span class="co">#&gt; Xs1         -0.401540   0.006568  -61.14   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="co">#&gt; Residual standard error: 0.2087 on 3994 degrees of freedom</span></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">#&gt; Multiple R-squared:  0.7409, Adjusted R-squared:  0.7406 </span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="co">#&gt; F-statistic:  2284 on 5 and 3994 DF,  p-value: &lt; 2.2e-16</span></a>
<a class="sourceLine" id="cb6-24" title="24"><span class="kw">summary</span>(eqmdl_reg)</a>
<a class="sourceLine" id="cb6-25" title="25"><span class="co">#&gt; Equilibrium Model for Markets in Equilibrium</span></a>
<a class="sourceLine" id="cb6-26" title="26"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb6-27" title="27"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb6-28" title="28"><span class="co">#&gt;   Market Clearing   : Q = D_Q = S_Q</span></a>
<a class="sourceLine" id="cb6-29" title="29"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb6-30" title="30"><span class="co">#&gt;   Nobs              : 4000</span></a>
<a class="sourceLine" id="cb6-31" title="31"><span class="co">#&gt;   Sample Separation : Not Separated</span></a>
<a class="sourceLine" id="cb6-32" title="32"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb6-33" title="33"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb6-34" title="34"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb6-35" title="35"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb6-36" title="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-37" title="37"><span class="co">#&gt; systemfit results </span></a>
<a class="sourceLine" id="cb6-38" title="38"><span class="co">#&gt; method: 2SLS </span></a>
<a class="sourceLine" id="cb6-39" title="39"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-40" title="40"><span class="co">#&gt;           N   DF     SSR  detRCov   OLS-R2 McElroy-R2</span></a>
<a class="sourceLine" id="cb6-41" title="41"><span class="co">#&gt; system 8000 7989 7765.49 0.838051 0.895447    0.90887</span></a>
<a class="sourceLine" id="cb6-42" title="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-43" title="43"><span class="co">#&gt;           N   DF     SSR      MSE    RMSE       R2   Adj R2</span></a>
<a class="sourceLine" id="cb6-44" title="44"><span class="co">#&gt; demand 4000 3994 2579.28 0.645789 0.80361 0.930546 0.930459</span></a>
<a class="sourceLine" id="cb6-45" title="45"><span class="co">#&gt; supply 4000 3995 5186.20 1.298174 1.13937 0.860348 0.860208</span></a>
<a class="sourceLine" id="cb6-46" title="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-47" title="47"><span class="co">#&gt; The covariance matrix of the residuals</span></a>
<a class="sourceLine" id="cb6-48" title="48"><span class="co">#&gt;            demand     supply</span></a>
<a class="sourceLine" id="cb6-49" title="49"><span class="co">#&gt; demand  0.6457891 -0.0171846</span></a>
<a class="sourceLine" id="cb6-50" title="50"><span class="co">#&gt; supply -0.0171846  1.2981739</span></a>
<a class="sourceLine" id="cb6-51" title="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-52" title="52"><span class="co">#&gt; The correlations of the residuals</span></a>
<a class="sourceLine" id="cb6-53" title="53"><span class="co">#&gt;            demand     supply</span></a>
<a class="sourceLine" id="cb6-54" title="54"><span class="co">#&gt; demand  1.0000000 -0.0187684</span></a>
<a class="sourceLine" id="cb6-55" title="55"><span class="co">#&gt; supply -0.0187684  1.0000000</span></a>
<a class="sourceLine" id="cb6-56" title="56"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-57" title="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-58" title="58"><span class="co">#&gt; 2SLS estimates for &#39;demand&#39; (equation 1)</span></a>
<a class="sourceLine" id="cb6-59" title="59"><span class="co">#&gt; Model Formula: Q ~ P + Xd1 + Xd2 + X1 + X2</span></a>
<a class="sourceLine" id="cb6-60" title="60"><span class="co">#&gt; &lt;environment: 0x56498eb4e920&gt;</span></a>
<a class="sourceLine" id="cb6-61" title="61"><span class="co">#&gt; Instruments: ~Xd1 + Xd2 + X1 + X2 + Xs1</span></a>
<a class="sourceLine" id="cb6-62" title="62"><span class="co">#&gt; &lt;environment: 0x56498eb4e920&gt;</span></a>
<a class="sourceLine" id="cb6-63" title="63"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-64" title="64"><span class="co">#&gt;               Estimate Std. Error  t value   Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb6-65" title="65"><span class="co">#&gt; (Intercept) 18.7291651  0.1529666 122.4395 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-66" title="66"><span class="co">#&gt; P           -3.8534666  0.0629681 -61.1971 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-67" title="67"><span class="co">#&gt; Xd1          2.1102794  0.0323478  65.2372 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-68" title="68"><span class="co">#&gt; Xd2         -0.7156455  0.0261205 -27.3978 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-69" title="69"><span class="co">#&gt; X1           3.5151555  0.0331078 106.1731 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-70" title="70"><span class="co">#&gt; X2           6.2431905  0.0314974 198.2126 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-71" title="71"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb6-72" title="72"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb6-73" title="73"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-74" title="74"><span class="co">#&gt; Residual standard error: 0.80361 on 3994 degrees of freedom</span></a>
<a class="sourceLine" id="cb6-75" title="75"><span class="co">#&gt; Number of observations: 4000 Degrees of Freedom: 3994 </span></a>
<a class="sourceLine" id="cb6-76" title="76"><span class="co">#&gt; SSR: 2579.281574 MSE: 0.645789 Root MSE: 0.80361 </span></a>
<a class="sourceLine" id="cb6-77" title="77"><span class="co">#&gt; Multiple R-Squared: 0.930546 Adjusted R-Squared: 0.930459 </span></a>
<a class="sourceLine" id="cb6-78" title="78"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-79" title="79"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-80" title="80"><span class="co">#&gt; 2SLS estimates for &#39;supply&#39; (equation 2)</span></a>
<a class="sourceLine" id="cb6-81" title="81"><span class="co">#&gt; Model Formula: Q ~ P + Xs1 + X1 + X2</span></a>
<a class="sourceLine" id="cb6-82" title="82"><span class="co">#&gt; &lt;environment: 0x56498eb4e920&gt;</span></a>
<a class="sourceLine" id="cb6-83" title="83"><span class="co">#&gt; Instruments: ~Xd1 + Xd2 + X1 + X2 + Xs1</span></a>
<a class="sourceLine" id="cb6-84" title="84"><span class="co">#&gt; &lt;environment: 0x56498eb4e920&gt;</span></a>
<a class="sourceLine" id="cb6-85" title="85"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-86" title="86"><span class="co">#&gt;              Estimate Std. Error  t value   Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb6-87" title="87"><span class="co">#&gt; (Intercept) 2.7596055  0.3499559  7.88558 3.9968e-15 ***</span></a>
<a class="sourceLine" id="cb6-88" title="88"><span class="co">#&gt; P           2.8849781  0.1084928 26.59143 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-89" title="89"><span class="co">#&gt; Xs1         2.7054083  0.0569035 47.54382 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-90" title="90"><span class="co">#&gt; X1          1.1758638  0.0515231 22.82207 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-91" title="91"><span class="co">#&gt; X2          4.1766642  0.0489108 85.39346 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb6-92" title="92"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb6-93" title="93"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb6-94" title="94"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-95" title="95"><span class="co">#&gt; Residual standard error: 1.139374 on 3995 degrees of freedom</span></a>
<a class="sourceLine" id="cb6-96" title="96"><span class="co">#&gt; Number of observations: 4000 Degrees of Freedom: 3995 </span></a>
<a class="sourceLine" id="cb6-97" title="97"><span class="co">#&gt; SSR: 5186.204766 MSE: 1.298174 Root MSE: 1.139374 </span></a>
<a class="sourceLine" id="cb6-98" title="98"><span class="co">#&gt; Multiple R-Squared: 0.860348 Adjusted R-Squared: 0.860208</span></a>
<a class="sourceLine" id="cb6-99" title="99"><span class="kw">summary</span>(eqmdl_fit)</a>
<a class="sourceLine" id="cb6-100" title="100"><span class="co">#&gt; Equilibrium Model for Markets in Equilibrium</span></a>
<a class="sourceLine" id="cb6-101" title="101"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb6-102" title="102"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb6-103" title="103"><span class="co">#&gt;   Market Clearing   : Q = D_Q = S_Q</span></a>
<a class="sourceLine" id="cb6-104" title="104"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb6-105" title="105"><span class="co">#&gt;   Nobs              : 4000</span></a>
<a class="sourceLine" id="cb6-106" title="106"><span class="co">#&gt;   Sample Separation : Not Separated</span></a>
<a class="sourceLine" id="cb6-107" title="107"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb6-108" title="108"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb6-109" title="109"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb6-110" title="110"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb6-111" title="111"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-112" title="112"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb6-113" title="113"><span class="co">#&gt;   Method              : BFGS</span></a>
<a class="sourceLine" id="cb6-114" title="114"><span class="co">#&gt;   Max Iterations      : 10000</span></a>
<a class="sourceLine" id="cb6-115" title="115"><span class="co">#&gt;   Relative Tolerance  : 1e-08</span></a>
<a class="sourceLine" id="cb6-116" title="116"><span class="co">#&gt;   Convergence Status  : success</span></a>
<a class="sourceLine" id="cb6-117" title="117"><span class="co">#&gt;   Starting Values     :</span></a>
<a class="sourceLine" id="cb6-118" title="118"><span class="co">#&gt;        D_P    D_CONST      D_Xd1      D_Xd2       D_X1       D_X2        S_P </span></a>
<a class="sourceLine" id="cb6-119" title="119"><span class="co">#&gt;    -2.6871    17.1339     1.7372    -0.5889     3.1155     5.8838     0.1426 </span></a>
<a class="sourceLine" id="cb6-120" title="120"><span class="co">#&gt;    S_CONST      S_Xs1       S_X1       S_X2 D_VARIANCE S_VARIANCE        RHO </span></a>
<a class="sourceLine" id="cb6-121" title="121"><span class="co">#&gt;    10.6921     1.5882     2.1173     5.0359     1.0000     1.0000     0.0000 </span></a>
<a class="sourceLine" id="cb6-122" title="122"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-123" title="123"><span class="co">#&gt; Coefficients</span></a>
<a class="sourceLine" id="cb6-124" title="124"><span class="co">#&gt;            Estimate Std. Error  z value      Pr(z)</span></a>
<a class="sourceLine" id="cb6-125" title="125"><span class="co">#&gt; D_P        -3.85348    0.06293 -61.2353  0.000e+00</span></a>
<a class="sourceLine" id="cb6-126" title="126"><span class="co">#&gt; D_CONST    18.73053    0.15336 122.1322  0.000e+00</span></a>
<a class="sourceLine" id="cb6-127" title="127"><span class="co">#&gt; D_Xd1       2.11014    0.03227  65.3909  0.000e+00</span></a>
<a class="sourceLine" id="cb6-128" title="128"><span class="co">#&gt; D_Xd2      -0.71602    0.02617 -27.3612 7.944e-165</span></a>
<a class="sourceLine" id="cb6-129" title="129"><span class="co">#&gt; D_X1        3.51516    0.03309 106.2424  0.000e+00</span></a>
<a class="sourceLine" id="cb6-130" title="130"><span class="co">#&gt; D_X2        6.24318    0.03147 198.3687  0.000e+00</span></a>
<a class="sourceLine" id="cb6-131" title="131"><span class="co">#&gt; S_P         2.88624    0.10846  26.6109 5.080e-156</span></a>
<a class="sourceLine" id="cb6-132" title="132"><span class="co">#&gt; S_CONST     2.75586    0.34985   7.8774  3.344e-15</span></a>
<a class="sourceLine" id="cb6-133" title="133"><span class="co">#&gt; S_Xs1       2.70593    0.05688  47.5696  0.000e+00</span></a>
<a class="sourceLine" id="cb6-134" title="134"><span class="co">#&gt; S_X1        1.17544    0.05150  22.8224 2.746e-115</span></a>
<a class="sourceLine" id="cb6-135" title="135"><span class="co">#&gt; S_X2        4.17628    0.04889  85.4181  0.000e+00</span></a>
<a class="sourceLine" id="cb6-136" title="136"><span class="co">#&gt; D_VARIANCE  0.64482    0.01899  33.9485 1.283e-252</span></a>
<a class="sourceLine" id="cb6-137" title="137"><span class="co">#&gt; S_VARIANCE  1.29703    0.05129  25.2886 4.267e-141</span></a>
<a class="sourceLine" id="cb6-138" title="138"><span class="co">#&gt; RHO        -0.01891    0.02353  -0.8034  4.217e-01</span></a>
<a class="sourceLine" id="cb6-139" title="139"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-140" title="140"><span class="co">#&gt; -2 log L: 6722.67</span></a>
<a class="sourceLine" id="cb6-141" title="141"><span class="kw">summary</span>(bsmdl_fit)</a>
<a class="sourceLine" id="cb6-142" title="142"><span class="co">#&gt; Basic Model for Markets in Disequilibrium</span></a>
<a class="sourceLine" id="cb6-143" title="143"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb6-144" title="144"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb6-145" title="145"><span class="co">#&gt;   Short Side Rule   : Q = min(D_Q, S_Q)</span></a>
<a class="sourceLine" id="cb6-146" title="146"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb6-147" title="147"><span class="co">#&gt;   Nobs              : 4000</span></a>
<a class="sourceLine" id="cb6-148" title="148"><span class="co">#&gt;   Sample Separation : Not Separated</span></a>
<a class="sourceLine" id="cb6-149" title="149"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb6-150" title="150"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb6-151" title="151"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb6-152" title="152"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb6-153" title="153"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-154" title="154"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb6-155" title="155"><span class="co">#&gt;   Method              : BFGS</span></a>
<a class="sourceLine" id="cb6-156" title="156"><span class="co">#&gt;   Max Iterations      : 10000</span></a>
<a class="sourceLine" id="cb6-157" title="157"><span class="co">#&gt;   Relative Tolerance  : 1e-08</span></a>
<a class="sourceLine" id="cb6-158" title="158"><span class="co">#&gt;   Convergence Status  : success</span></a>
<a class="sourceLine" id="cb6-159" title="159"><span class="co">#&gt;   Starting Values     :</span></a>
<a class="sourceLine" id="cb6-160" title="160"><span class="co">#&gt;        D_P    D_CONST      D_Xd1      D_Xd2       D_X1       D_X2        S_P </span></a>
<a class="sourceLine" id="cb6-161" title="161"><span class="co">#&gt;    -2.6871    17.1339     1.7372    -0.5889     3.1155     5.8838     0.1426 </span></a>
<a class="sourceLine" id="cb6-162" title="162"><span class="co">#&gt;    S_CONST      S_Xs1       S_X1       S_X2 D_VARIANCE S_VARIANCE        RHO </span></a>
<a class="sourceLine" id="cb6-163" title="163"><span class="co">#&gt;    10.6921     1.5882     2.1173     5.0359     1.0000     1.0000     0.0000 </span></a>
<a class="sourceLine" id="cb6-164" title="164"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-165" title="165"><span class="co">#&gt; Coefficients</span></a>
<a class="sourceLine" id="cb6-166" title="166"><span class="co">#&gt;            Estimate Std. Error z value      Pr(z)</span></a>
<a class="sourceLine" id="cb6-167" title="167"><span class="co">#&gt; D_P         -2.9119    0.07238 -40.233  0.000e+00</span></a>
<a class="sourceLine" id="cb6-168" title="168"><span class="co">#&gt; D_CONST     17.4679    0.21722  80.415  0.000e+00</span></a>
<a class="sourceLine" id="cb6-169" title="169"><span class="co">#&gt; D_Xd1        2.0264    0.04817  42.068  0.000e+00</span></a>
<a class="sourceLine" id="cb6-170" title="170"><span class="co">#&gt; D_Xd2       -0.7116    0.03279 -21.703 1.925e-104</span></a>
<a class="sourceLine" id="cb6-171" title="171"><span class="co">#&gt; D_X1         3.1680    0.04761  66.547  0.000e+00</span></a>
<a class="sourceLine" id="cb6-172" title="172"><span class="co">#&gt; D_X2         5.9840    0.04698 127.382  0.000e+00</span></a>
<a class="sourceLine" id="cb6-173" title="173"><span class="co">#&gt; S_P          0.9242    0.15942   5.797  6.755e-09</span></a>
<a class="sourceLine" id="cb6-174" title="174"><span class="co">#&gt; S_CONST      8.3532    0.56314  14.833  8.923e-50</span></a>
<a class="sourceLine" id="cb6-175" title="175"><span class="co">#&gt; S_Xs1        2.4675    0.11583  21.302 1.077e-100</span></a>
<a class="sourceLine" id="cb6-176" title="176"><span class="co">#&gt; S_X1         1.8785    0.09651  19.464  2.227e-84</span></a>
<a class="sourceLine" id="cb6-177" title="177"><span class="co">#&gt; S_X2         4.7120    0.10011  47.071  0.000e+00</span></a>
<a class="sourceLine" id="cb6-178" title="178"><span class="co">#&gt; D_VARIANCE   0.5960    0.02391  24.927 3.756e-137</span></a>
<a class="sourceLine" id="cb6-179" title="179"><span class="co">#&gt; S_VARIANCE   0.9703    0.07354  13.194  9.468e-40</span></a>
<a class="sourceLine" id="cb6-180" title="180"><span class="co">#&gt; RHO         -0.3355    0.05259  -6.379  1.788e-10</span></a>
<a class="sourceLine" id="cb6-181" title="181"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-182" title="182"><span class="co">#&gt; -2 log L: 8182.64</span></a>
<a class="sourceLine" id="cb6-183" title="183"><span class="kw">summary</span>(damdl_fit)</a>
<a class="sourceLine" id="cb6-184" title="184"><span class="co">#&gt; Deterministic Adjustment Model for Markets in Disequilibrium</span></a>
<a class="sourceLine" id="cb6-185" title="185"><span class="co">#&gt;   Demand RHS        : D_P + D_Xd1 + D_Xd2 + D_X1 + D_X2</span></a>
<a class="sourceLine" id="cb6-186" title="186"><span class="co">#&gt;   Supply RHS        : S_P + S_Xs1 + S_X1 + S_X2</span></a>
<a class="sourceLine" id="cb6-187" title="187"><span class="co">#&gt;   Short Side Rule   : Q = min(D_Q, S_Q)</span></a>
<a class="sourceLine" id="cb6-188" title="188"><span class="co">#&gt;   Separation Rule   : P_DIFF analogous to (D_Q - S_Q)</span></a>
<a class="sourceLine" id="cb6-189" title="189"><span class="co">#&gt;   Shocks            : Correlated</span></a>
<a class="sourceLine" id="cb6-190" title="190"><span class="co">#&gt;   Nobs              : 4000</span></a>
<a class="sourceLine" id="cb6-191" title="191"><span class="co">#&gt;   Sample Separation : Demand Obs = 1971, Supply Obs = 2029</span></a>
<a class="sourceLine" id="cb6-192" title="192"><span class="co">#&gt;   Quantity Var      : Q</span></a>
<a class="sourceLine" id="cb6-193" title="193"><span class="co">#&gt;   Price Var         : P</span></a>
<a class="sourceLine" id="cb6-194" title="194"><span class="co">#&gt;   Key Var(s)        : id, date</span></a>
<a class="sourceLine" id="cb6-195" title="195"><span class="co">#&gt;   Time Var          : date</span></a>
<a class="sourceLine" id="cb6-196" title="196"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-197" title="197"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb6-198" title="198"><span class="co">#&gt;   Method              : BFGS</span></a>
<a class="sourceLine" id="cb6-199" title="199"><span class="co">#&gt;   Max Iterations      : 10000</span></a>
<a class="sourceLine" id="cb6-200" title="200"><span class="co">#&gt;   Relative Tolerance  : 1e-08</span></a>
<a class="sourceLine" id="cb6-201" title="201"><span class="co">#&gt;   Convergence Status  : success</span></a>
<a class="sourceLine" id="cb6-202" title="202"><span class="co">#&gt;   Starting Values     :</span></a>
<a class="sourceLine" id="cb6-203" title="203"><span class="co">#&gt;        D_P    D_CONST      D_Xd1      D_Xd2       D_X1       D_X2        S_P </span></a>
<a class="sourceLine" id="cb6-204" title="204"><span class="co">#&gt;    -2.6871    17.1339     1.7372    -0.5889     3.1155     5.8838     0.1426 </span></a>
<a class="sourceLine" id="cb6-205" title="205"><span class="co">#&gt;    S_CONST      S_Xs1       S_X1       S_X2     P_DIFF D_VARIANCE S_VARIANCE </span></a>
<a class="sourceLine" id="cb6-206" title="206"><span class="co">#&gt;    10.6921     1.5882     2.1173     5.0359     1.0000     1.0000     1.0000 </span></a>
<a class="sourceLine" id="cb6-207" title="207"><span class="co">#&gt;        RHO </span></a>
<a class="sourceLine" id="cb6-208" title="208"><span class="co">#&gt;     0.0000 </span></a>
<a class="sourceLine" id="cb6-209" title="209"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-210" title="210"><span class="co">#&gt; Coefficients</span></a>
<a class="sourceLine" id="cb6-211" title="211"><span class="co">#&gt;             Estimate Std. Error  z value      Pr(z)</span></a>
<a class="sourceLine" id="cb6-212" title="212"><span class="co">#&gt; D_P        -3.848967    0.06636 -58.0023  0.000e+00</span></a>
<a class="sourceLine" id="cb6-213" title="213"><span class="co">#&gt; D_CONST    18.717272    0.16531 113.2287  0.000e+00</span></a>
<a class="sourceLine" id="cb6-214" title="214"><span class="co">#&gt; D_Xd1       2.110049    0.03227  65.3876  0.000e+00</span></a>
<a class="sourceLine" id="cb6-215" title="215"><span class="co">#&gt; D_Xd2      -0.716016    0.02617 -27.3624 7.681e-165</span></a>
<a class="sourceLine" id="cb6-216" title="216"><span class="co">#&gt; D_X1        3.515018    0.03309 106.2122  0.000e+00</span></a>
<a class="sourceLine" id="cb6-217" title="217"><span class="co">#&gt; D_X2        6.243126    0.03147 198.3693  0.000e+00</span></a>
<a class="sourceLine" id="cb6-218" title="218"><span class="co">#&gt; S_P         2.882241    0.11006  26.1867 3.763e-151</span></a>
<a class="sourceLine" id="cb6-219" title="219"><span class="co">#&gt; S_CONST     2.772435    0.35836   7.7364  1.022e-14</span></a>
<a class="sourceLine" id="cb6-220" title="220"><span class="co">#&gt; S_Xs1       2.705982    0.05689  47.5691  0.000e+00</span></a>
<a class="sourceLine" id="cb6-221" title="221"><span class="co">#&gt; S_X1        1.175343    0.05151  22.8185 3.001e-115</span></a>
<a class="sourceLine" id="cb6-222" title="222"><span class="co">#&gt; S_X2        4.176110    0.04890  85.4028  0.000e+00</span></a>
<a class="sourceLine" id="cb6-223" title="223"><span class="co">#&gt; P_DIFF      0.008358    0.03902   0.2142  8.304e-01</span></a>
<a class="sourceLine" id="cb6-224" title="224"><span class="co">#&gt; D_VARIANCE  0.644759    0.01900  33.9428 1.556e-252</span></a>
<a class="sourceLine" id="cb6-225" title="225"><span class="co">#&gt; S_VARIANCE  1.297088    0.05129  25.2875 4.389e-141</span></a>
<a class="sourceLine" id="cb6-226" title="226"><span class="co">#&gt; RHO        -0.018885    0.02353  -0.8025  4.223e-01</span></a>
<a class="sourceLine" id="cb6-227" title="227"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-228" title="228"><span class="co">#&gt; -2 log L: 6722.63</span></a></code></pre></div>
</div>
<div id="model-selection" class="section level3">
<h3>Model selection</h3>
<p>The deterministic adjustment model has price dynamics that are analogous to excess demand and estimates one extra parameter. The directional model estimates one parameter less as the model does not have enough equations to identify prices in both demand and supply equations. The estimated parameters are summarized as follows.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">sim_coef &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb7-2" title="2">  alpha_d, beta_d0, beta_d, eta_d,</a>
<a class="sourceLine" id="cb7-3" title="3">  alpha_s, beta_s0, beta_s, eta_s,</a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-5" title="5">  sigma_d, sigma_s,</a>
<a class="sourceLine" id="cb7-6" title="6">  rho_ds</a>
<a class="sourceLine" id="cb7-7" title="7">)</a>
<a class="sourceLine" id="cb7-8" title="8"><span class="kw">names</span>(sim_coef) &lt;-<span class="st"> </span><span class="kw">names</span>(<span class="kw">coef</span>(damdl_fit))</a>
<a class="sourceLine" id="cb7-9" title="9"></a>
<a class="sourceLine" id="cb7-10" title="10">dm_inc &lt;-<span class="st"> </span><span class="kw">coef</span>(eqmdl_reg)[</a>
<a class="sourceLine" id="cb7-11" title="11">  <span class="kw">grep</span>(<span class="st">&quot;demand&quot;</span>, <span class="kw">names</span>(<span class="kw">coef</span>(eqmdl_reg)))</a>
<a class="sourceLine" id="cb7-12" title="12">]</a>
<a class="sourceLine" id="cb7-13" title="13">sp_inc &lt;-<span class="st"> </span><span class="kw">coef</span>(eqmdl_reg)[</a>
<a class="sourceLine" id="cb7-14" title="14">  <span class="kw">grep</span>(<span class="st">&quot;supply&quot;</span>, <span class="kw">names</span>(<span class="kw">coef</span>(eqmdl_reg)))</a>
<a class="sourceLine" id="cb7-15" title="15">]</a>
<a class="sourceLine" id="cb7-16" title="16">lm_coef &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb7-17" title="17">  dm_inc[<span class="dv">2</span>], dm_inc[<span class="op">-</span><span class="dv">2</span>], sp_inc[<span class="dv">2</span>], sp_inc[<span class="op">-</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb7-18" title="18">  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-19" title="19">  <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-20" title="20">  <span class="ot">NA</span></a>
<a class="sourceLine" id="cb7-21" title="21">)</a>
<a class="sourceLine" id="cb7-22" title="22"></a>
<a class="sourceLine" id="cb7-23" title="23">eqmdl_coef &lt;-<span class="st"> </span><span class="kw">append</span>(</a>
<a class="sourceLine" id="cb7-24" title="24">  <span class="kw">coef</span>(eqmdl_fit), <span class="kw">c</span>(<span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb7-25" title="25">  <span class="dt">after =</span> <span class="kw">which</span>(<span class="kw">names</span>(<span class="kw">coef</span>(eqmdl_fit)) <span class="op">==</span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="st">    </span><span class="kw">prefixed_variance_variable</span>(eqmdl_fit<span class="op">@</span>system<span class="op">@</span>demand)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb7-27" title="27">)</a>
<a class="sourceLine" id="cb7-28" title="28"></a>
<a class="sourceLine" id="cb7-29" title="29">bsmdl_coef &lt;-<span class="st"> </span><span class="kw">append</span>(</a>
<a class="sourceLine" id="cb7-30" title="30">  <span class="kw">coef</span>(bsmdl_fit), <span class="kw">c</span>(<span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb7-31" title="31">  <span class="dt">after =</span> <span class="kw">which</span>(<span class="kw">names</span>(<span class="kw">coef</span>(bsmdl_fit)) <span class="op">==</span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="st">    </span><span class="kw">prefixed_variance_variable</span>(bsmdl_fit<span class="op">@</span>system<span class="op">@</span>demand)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb7-33" title="33">)</a>
<a class="sourceLine" id="cb7-34" title="34"></a>
<a class="sourceLine" id="cb7-35" title="35">damdl_coef &lt;-<span class="st"> </span><span class="kw">coef</span>(damdl_fit)</a>
<a class="sourceLine" id="cb7-36" title="36"></a>
<a class="sourceLine" id="cb7-37" title="37">comp &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb7-38" title="38">  <span class="dt">parameter =</span> <span class="kw">names</span>(sim_coef),</a>
<a class="sourceLine" id="cb7-39" title="39">  <span class="dt">sim =</span> sim_coef, <span class="dt">lm =</span> lm_coef, <span class="dt">fi =</span> eqmdl_coef,</a>
<a class="sourceLine" id="cb7-40" title="40">  <span class="dt">bm =</span> bsmdl_coef, <span class="dt">da =</span> damdl_coef,</a>
<a class="sourceLine" id="cb7-41" title="41">  <span class="dt">lmerr =</span> <span class="kw">abs</span>(lm_coef <span class="op">-</span><span class="st"> </span>sim_coef), <span class="dt">fierr =</span> <span class="kw">abs</span>(eqmdl_coef <span class="op">-</span><span class="st"> </span>sim_coef),</a>
<a class="sourceLine" id="cb7-42" title="42">  <span class="dt">bmerr =</span> <span class="kw">abs</span>(bsmdl_coef <span class="op">-</span><span class="st"> </span>sim_coef), <span class="dt">daerr =</span> <span class="kw">abs</span>(damdl_coef <span class="op">-</span><span class="st"> </span>sim_coef)</a>
<a class="sourceLine" id="cb7-43" title="43">)</a>
<a class="sourceLine" id="cb7-44" title="44">comp</a>
<a class="sourceLine" id="cb7-45" title="45"><span class="co">#&gt; # A tibble: 15 × 10</span></a>
<a class="sourceLine" id="cb7-46" title="46"><span class="co">#&gt;    parameter    sim     lm      fi     bm       da    lmerr    fierr   bmerr</span></a>
<a class="sourceLine" id="cb7-47" title="47"><span class="co">#&gt;    &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-48" title="48"><span class="co">#&gt;  1 D_P        -3.9  -3.85  -3.85   -2.91  -3.85     0.0465   0.0465   0.988 </span></a>
<a class="sourceLine" id="cb7-49" title="49"><span class="co">#&gt;  2 D_CONST    18.9  18.7   18.7    17.5   18.7      0.171    0.169    1.43  </span></a>
<a class="sourceLine" id="cb7-50" title="50"><span class="co">#&gt;  3 D_Xd1       2.1   2.11   2.11    2.03   2.11     0.0103   0.0101   0.0736</span></a>
<a class="sourceLine" id="cb7-51" title="51"><span class="co">#&gt;  4 D_Xd2      -0.7  -0.716 -0.716  -0.712 -0.716    0.0156   0.0160   0.0116</span></a>
<a class="sourceLine" id="cb7-52" title="52"><span class="co">#&gt;  5 D_X1        3.5   3.52   3.52    3.17   3.52     0.0152   0.0152   0.332 </span></a>
<a class="sourceLine" id="cb7-53" title="53"><span class="co">#&gt;  6 D_X2        6.25  6.24   6.24    5.98   6.24     0.00681  0.00682  0.266 </span></a>
<a class="sourceLine" id="cb7-54" title="54"><span class="co">#&gt;  7 S_P         2.8   2.88   2.89    0.924  2.88     0.0850   0.0862   1.88  </span></a>
<a class="sourceLine" id="cb7-55" title="55"><span class="co">#&gt;  8 S_CONST     3.2   2.76   2.76    8.35   2.77     0.440    0.444    5.15  </span></a>
<a class="sourceLine" id="cb7-56" title="56"><span class="co">#&gt;  9 S_Xs1       2.65  2.71   2.71    2.47   2.71     0.0554   0.0559   0.182 </span></a>
<a class="sourceLine" id="cb7-57" title="57"><span class="co">#&gt; 10 S_X1        1.15  1.18   1.18    1.88   1.18     0.0259   0.0254   0.729 </span></a>
<a class="sourceLine" id="cb7-58" title="58"><span class="co">#&gt; 11 S_X2        4.2   4.18   4.18    4.71   4.18     0.0233   0.0237   0.512 </span></a>
<a class="sourceLine" id="cb7-59" title="59"><span class="co">#&gt; 12 P_DIFF     NA    NA     NA      NA      0.00836 NA       NA       NA     </span></a>
<a class="sourceLine" id="cb7-60" title="60"><span class="co">#&gt; 13 D_VARIANCE  0.8  NA      0.645   0.596  0.645   NA        0.155    0.204 </span></a>
<a class="sourceLine" id="cb7-61" title="61"><span class="co">#&gt; 14 S_VARIANCE  1.1  NA      1.30    0.970  1.30    NA        0.197    0.130 </span></a>
<a class="sourceLine" id="cb7-62" title="62"><span class="co">#&gt; 15 RHO         0    NA     -0.0189 -0.335 -0.0189  NA        0.0189   0.335 </span></a>
<a class="sourceLine" id="cb7-63" title="63"><span class="co">#&gt; # … with 1 more variable: daerr &lt;dbl&gt;</span></a></code></pre></div>
<p>Since we have used simulated data, we can calculate the average absolute error of the parameter estimation for each of the models. In practice, the population values are unknown and this calculation is impossible.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">comp_means &lt;-<span class="st"> </span><span class="kw">colMeans</span>(comp[, <span class="kw">grep</span>(<span class="st">&quot;err&quot;</span>, <span class="kw">colnames</span>(comp))], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-2" title="2">comp_means</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt;      lmerr      fierr      bmerr      daerr </span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; 0.08138534 0.09076426 0.87318787 0.09056802</span></a></code></pre></div>
<p>Moreover, the average absolute error cannot provide an overall estimation assessment as the market models have different parameter spaces. To assess the overall model performance one can instead use an information criterion.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">model_names &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb9-2" title="2">  eqmdl_fit<span class="op">@</span>model_type_string,</a>
<a class="sourceLine" id="cb9-3" title="3">  bsmdl_fit<span class="op">@</span>model_type_string, damdl_fit<span class="op">@</span>model_type_string</a>
<a class="sourceLine" id="cb9-4" title="4">)</a>
<a class="sourceLine" id="cb9-5" title="5">model_obs &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">nobs</span>(eqmdl_fit), <span class="kw">nobs</span>(bsmdl_fit), <span class="kw">nobs</span>(damdl_fit))</a>
<a class="sourceLine" id="cb9-6" title="6">model_errors &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb9-7" title="7">  comp_means[<span class="st">&quot;fierr&quot;</span>],</a>
<a class="sourceLine" id="cb9-8" title="8">  comp_means[<span class="st">&quot;bmerr&quot;</span>],</a>
<a class="sourceLine" id="cb9-9" title="9">  comp_means[<span class="st">&quot;daerr&quot;</span>]</a>
<a class="sourceLine" id="cb9-10" title="10">)</a>
<a class="sourceLine" id="cb9-11" title="11">seltbl &lt;-<span class="st"> </span><span class="kw">AIC</span>(eqmdl_fit, bsmdl_fit, damdl_fit) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="st">  </span>tibble<span class="op">::</span><span class="kw">add_column</span>(<span class="dt">Model =</span> model_names, <span class="dt">.before =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="st">  </span>tibble<span class="op">::</span><span class="kw">add_column</span>(<span class="dt">Obs. =</span> model_obs, <span class="st">`</span><span class="dt">Mean Error</span><span class="st">`</span> =<span class="st"> </span>model_errors) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-14" title="14"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">D.F. =</span> df) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(AIC)</a>
<a class="sourceLine" id="cb9-16" title="16">seltbl</a>
<a class="sourceLine" id="cb9-17" title="17"><span class="co">#&gt;                              Model D.F.      AIC Obs. Mean Error</span></a>
<a class="sourceLine" id="cb9-18" title="18"><span class="co">#&gt; eqmdl_fit              Equilibrium   14 6750.671 4000 0.09076426</span></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#&gt; damdl_fit Deterministic Adjustment   15 6752.625 4000 0.09056802</span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="co">#&gt; bsmdl_fit                    Basic   14 8210.640 4000 0.87318787</span></a></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
