<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Assessing market equilibrium</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Assessing market equilibrium</h1>



<p>This short tutorial gives an example of how one can statistically assess whether a market is in an equilibrium state. The tutorial assumes some familiarity with the concepts and the functionality of the package. The <a href="basic_usage.html">basic_usage</a> vignette can be helpful in acquiring this familiarity.</p>
<div id="setup-the-environment" class="section level2">
<h2>Setup the environment</h2>
<p>Load the required libraries.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(diseq)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(magrittr)</a></code></pre></div>
<p>Prepare the data. Here, we simply simulate data using a data generating process for a market in equilibrium.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">nobs &lt;-<span class="st"> </span><span class="dv">5000</span></a>
<a class="sourceLine" id="cb2-2" title="2">tobs &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4">alpha_d &lt;-<span class="st"> </span><span class="fl">-1.9</span></a>
<a class="sourceLine" id="cb2-5" title="5">beta_d0 &lt;-<span class="st"> </span><span class="fl">4.9</span></a>
<a class="sourceLine" id="cb2-6" title="6">beta_d &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.1</span>, <span class="fl">-0.7</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">eta_d &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">3.5</span>, <span class="fl">6.25</span>)</a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9">alpha_s &lt;-<span class="st"> </span><span class="fl">2.8</span></a>
<a class="sourceLine" id="cb2-10" title="10">beta_s0 &lt;-<span class="st"> </span><span class="fl">1.2</span></a>
<a class="sourceLine" id="cb2-11" title="11">beta_s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.65</span>)</a>
<a class="sourceLine" id="cb2-12" title="12">eta_s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.15</span>, <span class="fl">4.2</span>)</a>
<a class="sourceLine" id="cb2-13" title="13"></a>
<a class="sourceLine" id="cb2-14" title="14">sigma_d &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-15" title="15">sigma_s &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-16" title="16">rho_ds &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb2-17" title="17"></a>
<a class="sourceLine" id="cb2-18" title="18">seed &lt;-<span class="st"> </span><span class="dv">443</span></a>
<a class="sourceLine" id="cb2-19" title="19"></a>
<a class="sourceLine" id="cb2-20" title="20">eq_data &lt;-<span class="st"> </span><span class="kw">simulate_model_data</span>(</a>
<a class="sourceLine" id="cb2-21" title="21">  <span class="st">&quot;eq_fiml&quot;</span>, nobs, tobs,</a>
<a class="sourceLine" id="cb2-22" title="22">  alpha_d, beta_d0, beta_d, eta_d,</a>
<a class="sourceLine" id="cb2-23" title="23">  alpha_s, beta_s0, beta_s, eta_s,</a>
<a class="sourceLine" id="cb2-24" title="24">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="kw">c</span>(<span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb2-25" title="25">  <span class="dt">sigma_d =</span> sigma_d, <span class="dt">sigma_s =</span> sigma_s, <span class="dt">rho_ds =</span> rho_ds,</a>
<a class="sourceLine" id="cb2-26" title="26">  <span class="dt">seed =</span> seed</a>
<a class="sourceLine" id="cb2-27" title="27">)</a></code></pre></div>
</div>
<div id="initialize-the-model" class="section level2">
<h2>Initialize the model</h2>
<p>Prepare the basic parameters for model initialization.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">key_columns &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;id&quot;</span>, <span class="st">&quot;date&quot;</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">time_column &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;date&quot;</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">quantity_column &lt;-<span class="st"> &quot;Q&quot;</span></a>
<a class="sourceLine" id="cb3-4" title="4">price_column &lt;-<span class="st"> &quot;P&quot;</span></a>
<a class="sourceLine" id="cb3-5" title="5">demand_specification &lt;-<span class="st"> </span><span class="kw">paste0</span>(price_column, <span class="st">&quot; + Xd1 + Xd2 + X1 + X2&quot;</span>)</a>
<a class="sourceLine" id="cb3-6" title="6">supply_specification &lt;-<span class="st"> &quot;Xs1 + X1 + X2&quot;</span></a>
<a class="sourceLine" id="cb3-7" title="7">price_specification &lt;-<span class="st"> &quot;Xp1&quot;</span></a>
<a class="sourceLine" id="cb3-8" title="8">verbose &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb3-9" title="9">use_correlated_shocks &lt;-<span class="st"> </span><span class="ot">TRUE</span></a></code></pre></div>
<p>Using the above parameterization, construct the model objects. Here we construct two equilibrium models and four disequilibrium models. All the models are constructed using the simulated data from a model of market in equilibrium.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">eq2sls &lt;-<span class="st"> </span><span class="kw">new</span>(</a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="st">&quot;eq_2sls&quot;</span>,</a>
<a class="sourceLine" id="cb4-3" title="3">  key_columns,</a>
<a class="sourceLine" id="cb4-4" title="4">  quantity_column, price_column,</a>
<a class="sourceLine" id="cb4-5" title="5">  demand_specification, <span class="kw">paste0</span>(price_column, <span class="st">&quot; + &quot;</span>, supply_specification),</a>
<a class="sourceLine" id="cb4-6" title="6">  eq_data[eq_data<span class="op">$</span>date <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="dt">verbose =</span> verbose</a>
<a class="sourceLine" id="cb4-8" title="8">)</a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; Info: This is &#39;Equilibrium 2SLS with independent shocks&#39; model</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; Warning: Removing unobserved &#39;1&#39; level(s).</span></a>
<a class="sourceLine" id="cb4-11" title="11">eqfiml &lt;-<span class="st"> </span><span class="kw">new</span>(</a>
<a class="sourceLine" id="cb4-12" title="12">  <span class="st">&quot;eq_fiml&quot;</span>,</a>
<a class="sourceLine" id="cb4-13" title="13">  key_columns,</a>
<a class="sourceLine" id="cb4-14" title="14">  quantity_column, price_column,</a>
<a class="sourceLine" id="cb4-15" title="15">  demand_specification, <span class="kw">paste0</span>(price_column, <span class="st">&quot; + &quot;</span>, supply_specification),</a>
<a class="sourceLine" id="cb4-16" title="16">  eq_data[eq_data<span class="op">$</span>date <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb4-17" title="17">  <span class="dt">use_correlated_shocks =</span> use_correlated_shocks, <span class="dt">verbose =</span> verbose</a>
<a class="sourceLine" id="cb4-18" title="18">)</a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt; Info: This is &#39;Equilibrium FIML with correlated shocks&#39; model</span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt; Warning: Removing unobserved &#39;1&#39; level(s).</span></a>
<a class="sourceLine" id="cb4-21" title="21">bsmdl &lt;-<span class="st"> </span><span class="kw">new</span>(</a>
<a class="sourceLine" id="cb4-22" title="22">  <span class="st">&quot;diseq_basic&quot;</span>,</a>
<a class="sourceLine" id="cb4-23" title="23">  key_columns,</a>
<a class="sourceLine" id="cb4-24" title="24">  quantity_column, price_column,</a>
<a class="sourceLine" id="cb4-25" title="25">  demand_specification, <span class="kw">paste0</span>(price_column, <span class="st">&quot; + &quot;</span>, supply_specification),</a>
<a class="sourceLine" id="cb4-26" title="26">  eq_data[eq_data<span class="op">$</span>date <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>, ],</a>
<a class="sourceLine" id="cb4-27" title="27">  <span class="dt">use_correlated_shocks =</span> use_correlated_shocks, <span class="dt">verbose =</span> verbose</a>
<a class="sourceLine" id="cb4-28" title="28">)</a>
<a class="sourceLine" id="cb4-29" title="29"><span class="co">#&gt; Info: This is &#39;Basic with correlated shocks&#39; model</span></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="co">#&gt; Warning: Removing unobserved &#39;1&#39; level(s).</span></a>
<a class="sourceLine" id="cb4-31" title="31">damdl &lt;-<span class="st"> </span><span class="kw">new</span>(</a>
<a class="sourceLine" id="cb4-32" title="32">  <span class="st">&quot;diseq_deterministic_adjustment&quot;</span>,</a>
<a class="sourceLine" id="cb4-33" title="33">  key_columns, time_column,</a>
<a class="sourceLine" id="cb4-34" title="34">  quantity_column, price_column,</a>
<a class="sourceLine" id="cb4-35" title="35">  demand_specification, <span class="kw">paste0</span>(price_column, <span class="st">&quot; + &quot;</span>, supply_specification),</a>
<a class="sourceLine" id="cb4-36" title="36">  eq_data,</a>
<a class="sourceLine" id="cb4-37" title="37">  <span class="dt">use_correlated_shocks =</span> use_correlated_shocks, <span class="dt">verbose =</span> verbose</a>
<a class="sourceLine" id="cb4-38" title="38">)</a>
<a class="sourceLine" id="cb4-39" title="39"><span class="co">#&gt; Info: This is &#39;Deterministic Adjustment with correlated shocks&#39; model</span></a>
<a class="sourceLine" id="cb4-40" title="40"><span class="co">#&gt; Info: Dropping 5000 rows by generating &#39;LAGGED_P&#39;.</span></a>
<a class="sourceLine" id="cb4-41" title="41"><span class="co">#&gt; Info: Sample separated with 10003 rows in excess supply and 9997 in excess demand regime.</span></a></code></pre></div>
</div>
<div id="estimation" class="section level2">
<h2>Estimation</h2>
<p>Set the estimation parameters.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">optimization_method &lt;-<span class="st"> &quot;BFGS&quot;</span></a>
<a class="sourceLine" id="cb5-2" title="2">optimization_controls &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">maxit =</span> <span class="dv">10000</span>, <span class="dt">reltol =</span> <span class="fl">1e-8</span>)</a></code></pre></div>
<p>Estimate the models.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">eq2sls &lt;-<span class="st"> </span><span class="kw">estimate</span>(eq2sls)</a>
<a class="sourceLine" id="cb6-2" title="2">eqfiml_est &lt;-<span class="st"> </span><span class="kw">estimate</span>(eqfiml,</a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="dt">control =</span> optimization_controls,</a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="dt">method =</span> optimization_method</a>
<a class="sourceLine" id="cb6-5" title="5">)</a>
<a class="sourceLine" id="cb6-6" title="6">bsmdl_est &lt;-<span class="st"> </span><span class="kw">estimate</span>(bsmdl,</a>
<a class="sourceLine" id="cb6-7" title="7">  <span class="dt">control =</span> optimization_controls,</a>
<a class="sourceLine" id="cb6-8" title="8">  <span class="dt">method =</span> optimization_method</a>
<a class="sourceLine" id="cb6-9" title="9">)</a>
<a class="sourceLine" id="cb6-10" title="10">damdl_est &lt;-<span class="st"> </span><span class="kw">estimate</span>(damdl,</a>
<a class="sourceLine" id="cb6-11" title="11">  <span class="dt">control =</span> optimization_controls,</a>
<a class="sourceLine" id="cb6-12" title="12">  <span class="dt">method =</span> optimization_method</a>
<a class="sourceLine" id="cb6-13" title="13">)</a></code></pre></div>
</div>
<div id="post-estimation-analysis" class="section level2">
<h2>Post estimation analysis</h2>
<div id="summaries" class="section level3">
<h3>Summaries</h3>
<p>All the models provide estimates for the simulated data. Even with simulated data, it is difficult to assess which model performs better by examining only the summaries in separation or collectively.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">summary</span>(eq2sls<span class="op">@</span>first_stage_model)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; lm(formula = first_stage_formula, data = object@model_tibble)</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; Residuals:</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; -0.85453 -0.14407  0.00004  0.14368  0.78798 </span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; (Intercept)  0.761849   0.017106   44.54   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; Xd1          0.448077   0.003055  146.68   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt; Xd2         -0.144864   0.003056  -47.41   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt; X1           0.505181   0.003026  166.92   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt; X2           0.437596   0.003072  142.44   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt; Xs1         -0.139496   0.003057  -45.63   &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#&gt; Residual standard error: 0.215 on 19994 degrees of freedom</span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#&gt; Multiple R-squared:  0.7873, Adjusted R-squared:  0.7873 </span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">#&gt; F-statistic: 1.48e+04 on 5 and 19994 DF,  p-value: &lt; 2.2e-16</span></a>
<a class="sourceLine" id="cb7-24" title="24"><span class="kw">summary</span>(eq2sls<span class="op">@</span>system_model)</a>
<a class="sourceLine" id="cb7-25" title="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-26" title="26"><span class="co">#&gt; systemfit results </span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="co">#&gt; method: 2SLS </span></a>
<a class="sourceLine" id="cb7-28" title="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="co">#&gt;            N    DF     SSR detRCov   OLS-R2 McElroy-R2</span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="co">#&gt; system 40000 39989 30544.3 8.5e-05 0.923359   0.846725</span></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="co">#&gt;            N    DF     SSR      MSE     RMSE       R2   Adj R2</span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="co">#&gt; demand 20000 19994 15271.1 0.763782 0.873946 0.923364 0.923345</span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="co">#&gt; supply 20000 19995 15273.3 0.763855 0.873988 0.923353 0.923338</span></a>
<a class="sourceLine" id="cb7-35" title="35"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="co">#&gt; The covariance matrix of the residuals</span></a>
<a class="sourceLine" id="cb7-37" title="37"><span class="co">#&gt;          demand   supply</span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="co">#&gt; demand 0.763782 0.763763</span></a>
<a class="sourceLine" id="cb7-39" title="39"><span class="co">#&gt; supply 0.763763 0.763855</span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-41" title="41"><span class="co">#&gt; The correlations of the residuals</span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="co">#&gt;          demand   supply</span></a>
<a class="sourceLine" id="cb7-43" title="43"><span class="co">#&gt; demand 1.000000 0.999927</span></a>
<a class="sourceLine" id="cb7-44" title="44"><span class="co">#&gt; supply 0.999927 1.000000</span></a>
<a class="sourceLine" id="cb7-45" title="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-46" title="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-47" title="47"><span class="co">#&gt; 2SLS estimates for &#39;demand&#39; (equation 1)</span></a>
<a class="sourceLine" id="cb7-48" title="48"><span class="co">#&gt; Model Formula: Q ~ P_FITTED + Xd1 + Xd2 + X1 + X2</span></a>
<a class="sourceLine" id="cb7-49" title="49"><span class="co">#&gt; &lt;environment: 0x55fc93a1f1a8&gt;</span></a>
<a class="sourceLine" id="cb7-50" title="50"><span class="co">#&gt; Instruments: ~Xd1 + Xd2 + X1 + X2 + Xs1</span></a>
<a class="sourceLine" id="cb7-51" title="51"><span class="co">#&gt; &lt;environment: 0x55fc93a1f1a8&gt;</span></a>
<a class="sourceLine" id="cb7-52" title="52"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-53" title="53"><span class="co">#&gt;               Estimate Std. Error  t value   Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb7-54" title="54"><span class="co">#&gt; (Intercept)  4.8762033  0.0722859  67.4571 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb7-55" title="55"><span class="co">#&gt; P_FITTED    -1.8442136  0.0890651 -20.7064 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb7-56" title="56"><span class="co">#&gt; Xd1          2.0524139  0.0418253  49.0712 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb7-57" title="57"><span class="co">#&gt; Xd2         -0.6858288  0.0179589 -38.1887 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb7-58" title="58"><span class="co">#&gt; X1           3.5025023  0.0466818  75.0293 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb7-59" title="59"><span class="co">#&gt; X2           6.2117062  0.0409079 151.8463 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb7-60" title="60"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb7-61" title="61"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb7-62" title="62"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-63" title="63"><span class="co">#&gt; Residual standard error: 0.873946 on 19994 degrees of freedom</span></a>
<a class="sourceLine" id="cb7-64" title="64"><span class="co">#&gt; Number of observations: 20000 Degrees of Freedom: 19994 </span></a>
<a class="sourceLine" id="cb7-65" title="65"><span class="co">#&gt; SSR: 15271.060811 MSE: 0.763782 Root MSE: 0.873946 </span></a>
<a class="sourceLine" id="cb7-66" title="66"><span class="co">#&gt; Multiple R-Squared: 0.923364 Adjusted R-Squared: 0.923345 </span></a>
<a class="sourceLine" id="cb7-67" title="67"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-68" title="68"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-69" title="69"><span class="co">#&gt; 2SLS estimates for &#39;supply&#39; (equation 2)</span></a>
<a class="sourceLine" id="cb7-70" title="70"><span class="co">#&gt; Model Formula: Q ~ P_FITTED + Xs1 + X1 + X2</span></a>
<a class="sourceLine" id="cb7-71" title="71"><span class="co">#&gt; &lt;environment: 0x55fc93a1f1a8&gt;</span></a>
<a class="sourceLine" id="cb7-72" title="72"><span class="co">#&gt; Instruments: ~Xd1 + Xd2 + X1 + X2 + Xs1</span></a>
<a class="sourceLine" id="cb7-73" title="73"><span class="co">#&gt; &lt;environment: 0x55fc93a1f1a8&gt;</span></a>
<a class="sourceLine" id="cb7-74" title="74"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-75" title="75"><span class="co">#&gt;              Estimate Std. Error  t value   Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb7-76" title="76"><span class="co">#&gt; (Intercept) 1.3095281  0.0673668  19.4388 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb7-77" title="77"><span class="co">#&gt; P_FITTED    2.7509924  0.0263305 104.4792 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb7-78" title="78"><span class="co">#&gt; Xs1         0.6409146  0.0129713  49.4101 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb7-79" title="79"><span class="co">#&gt; X1          1.1808148  0.0181389  65.0984 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb7-80" title="80"><span class="co">#&gt; X2          4.2008260  0.0170625 246.2027 &lt; 2.22e-16 ***</span></a>
<a class="sourceLine" id="cb7-81" title="81"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb7-82" title="82"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb7-83" title="83"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-84" title="84"><span class="co">#&gt; Residual standard error: 0.873988 on 19995 degrees of freedom</span></a>
<a class="sourceLine" id="cb7-85" title="85"><span class="co">#&gt; Number of observations: 20000 Degrees of Freedom: 19995 </span></a>
<a class="sourceLine" id="cb7-86" title="86"><span class="co">#&gt; SSR: 15273.281424 MSE: 0.763855 Root MSE: 0.873988 </span></a>
<a class="sourceLine" id="cb7-87" title="87"><span class="co">#&gt; Multiple R-Squared: 0.923353 Adjusted R-Squared: 0.923338</span></a>
<a class="sourceLine" id="cb7-88" title="88">bbmle<span class="op">::</span><span class="kw">summary</span>(eqfiml_est)</a>
<a class="sourceLine" id="cb7-89" title="89"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb7-90" title="90"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-91" title="91"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb7-92" title="92"><span class="co">#&gt; `bbmle::mle2`(list(control = list(maxit = 10000, reltol = 1e-08), </span></a>
<a class="sourceLine" id="cb7-93" title="93"><span class="co">#&gt;     method = &quot;BFGS&quot;, start = c(D_P = 0.248904000229706, D_CONST = 4.01094480918336, </span></a>
<a class="sourceLine" id="cb7-94" title="94"><span class="co">#&gt;     D_Xd1 = 1.1137756892884, D_Xd2 = -0.380925520464488, D_X1 = 2.44419761908979, </span></a>
<a class="sourceLine" id="cb7-95" title="95"><span class="co">#&gt;     D_X2 = 5.29620369779804, S_P = 1.70876661459514, S_CONST = 2.885697667298, </span></a>
<a class="sourceLine" id="cb7-96" title="96"><span class="co">#&gt;     S_Xs1 = 0.493421828653425, S_X1 = 1.70854379946901, S_X2 = 4.66113245104969, </span></a>
<a class="sourceLine" id="cb7-97" title="97"><span class="co">#&gt;     D_VARIANCE = 1, S_VARIANCE = 1, RHO = 0), minuslogl = function (...) </span></a>
<a class="sourceLine" id="cb7-98" title="98"><span class="co">#&gt;     minus_log_likelihood(object, ...), gr = function (...) </span></a>
<a class="sourceLine" id="cb7-99" title="99"><span class="co">#&gt;     gradient(object, ...)))</span></a>
<a class="sourceLine" id="cb7-100" title="100"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-101" title="101"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb7-102" title="102"><span class="co">#&gt;             Estimate Std. Error z value     Pr(z)    </span></a>
<a class="sourceLine" id="cb7-103" title="103"><span class="co">#&gt; D_P        -1.847620   0.102162 -18.085 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-104" title="104"><span class="co">#&gt; D_CONST     4.845601   0.079952  60.606 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-105" title="105"><span class="co">#&gt; D_Xd1       2.057105   0.047842  42.998 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-106" title="106"><span class="co">#&gt; D_Xd2      -0.676054   0.019563 -34.558 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-107" title="107"><span class="co">#&gt; D_X1        3.503609   0.053540  65.439 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-108" title="108"><span class="co">#&gt; D_X2        6.213180   0.046915 132.435 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-109" title="109"><span class="co">#&gt; S_P         2.750472   0.030038  91.567 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-110" title="110"><span class="co">#&gt; S_CONST     1.311502   0.076848  17.066 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-111" title="111"><span class="co">#&gt; S_Xs1       0.640863   0.014796  43.313 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-112" title="112"><span class="co">#&gt; S_X1        1.180568   0.020695  57.045 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-113" title="113"><span class="co">#&gt; S_X2        4.201078   0.019466 215.811 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-114" title="114"><span class="co">#&gt; D_VARIANCE  1.001167   0.024052  41.625 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-115" title="115"><span class="co">#&gt; S_VARIANCE  0.994439   0.011789  84.353 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-116" title="116"><span class="co">#&gt; RHO         0.510389   0.017863  28.572 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-117" title="117"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb7-118" title="118"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb7-119" title="119"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-120" title="120"><span class="co">#&gt; -2 log L: 46374.23</span></a>
<a class="sourceLine" id="cb7-121" title="121">bbmle<span class="op">::</span><span class="kw">summary</span>(bsmdl_est)</a>
<a class="sourceLine" id="cb7-122" title="122"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb7-123" title="123"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-124" title="124"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb7-125" title="125"><span class="co">#&gt; `bbmle::mle2`(list(control = list(maxit = 10000, reltol = 1e-08), </span></a>
<a class="sourceLine" id="cb7-126" title="126"><span class="co">#&gt;     method = &quot;BFGS&quot;, skip.hessian = FALSE, start = c(D_P = 0.248904000229706, </span></a>
<a class="sourceLine" id="cb7-127" title="127"><span class="co">#&gt;     D_CONST = 4.01094480918336, D_Xd1 = 1.1137756892884, D_Xd2 = -0.380925520464488, </span></a>
<a class="sourceLine" id="cb7-128" title="128"><span class="co">#&gt;     D_X1 = 2.44419761908979, D_X2 = 5.29620369779804, S_P = 1.70876661459514, </span></a>
<a class="sourceLine" id="cb7-129" title="129"><span class="co">#&gt;     S_CONST = 2.885697667298, S_Xs1 = 0.493421828653425, S_X1 = 1.70854379946901, </span></a>
<a class="sourceLine" id="cb7-130" title="130"><span class="co">#&gt;     S_X2 = 4.66113245104969, D_VARIANCE = 1, S_VARIANCE = 1, </span></a>
<a class="sourceLine" id="cb7-131" title="131"><span class="co">#&gt;     RHO = 0), minuslogl = function (...) </span></a>
<a class="sourceLine" id="cb7-132" title="132"><span class="co">#&gt;     minus_log_likelihood(object, ...), gr = function (...) </span></a>
<a class="sourceLine" id="cb7-133" title="133"><span class="co">#&gt;     gradient(object, ...)))</span></a>
<a class="sourceLine" id="cb7-134" title="134"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-135" title="135"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb7-136" title="136"><span class="co">#&gt;             Estimate Std. Error  z value     Pr(z)    </span></a>
<a class="sourceLine" id="cb7-137" title="137"><span class="co">#&gt; D_P         0.049812   0.053832   0.9253 0.3548000    </span></a>
<a class="sourceLine" id="cb7-138" title="138"><span class="co">#&gt; D_CONST     4.014641   0.115685  34.7033 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-139" title="139"><span class="co">#&gt; D_Xd1       1.322024   0.036993  35.7369 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-140" title="140"><span class="co">#&gt; D_Xd2      -0.455326   0.019782 -23.0177 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-141" title="141"><span class="co">#&gt; D_X1        2.577838   0.037536  68.6762 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-142" title="142"><span class="co">#&gt; D_X2        5.390141   0.034642 155.5962 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-143" title="143"><span class="co">#&gt; S_P         1.761937   0.105878  16.6412 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-144" title="144"><span class="co">#&gt; S_CONST     2.836331   0.359832   7.8824 3.212e-15 ***</span></a>
<a class="sourceLine" id="cb7-145" title="145"><span class="co">#&gt; S_Xs1       1.119391   0.086554  12.9329 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-146" title="146"><span class="co">#&gt; S_X1        1.575385   0.091235  17.2674 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-147" title="147"><span class="co">#&gt; S_X2        4.613717   0.082291  56.0662 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-148" title="148"><span class="co">#&gt; D_VARIANCE  0.822471   0.017428  47.1932 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-149" title="149"><span class="co">#&gt; S_VARIANCE  1.372021   0.090718  15.1240 &lt; 2.2e-16 ***</span></a>
<a class="sourceLine" id="cb7-150" title="150"><span class="co">#&gt; RHO         0.204999   0.056839   3.6066 0.0003102 ***</span></a>
<a class="sourceLine" id="cb7-151" title="151"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb7-152" title="152"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb7-153" title="153"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-154" title="154"><span class="co">#&gt; -2 log L: 51245.47</span></a>
<a class="sourceLine" id="cb7-155" title="155">bbmle<span class="op">::</span><span class="kw">summary</span>(damdl_est)</a>
<a class="sourceLine" id="cb7-156" title="156"><span class="co">#&gt; Maximum likelihood estimation</span></a>
<a class="sourceLine" id="cb7-157" title="157"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-158" title="158"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb7-159" title="159"><span class="co">#&gt; `bbmle::mle2`(list(control = list(maxit = 10000, reltol = 1e-08), </span></a>
<a class="sourceLine" id="cb7-160" title="160"><span class="co">#&gt;     method = &quot;BFGS&quot;, skip.hessian = FALSE, start = c(D_P = 0.248904000229706, </span></a>
<a class="sourceLine" id="cb7-161" title="161"><span class="co">#&gt;     D_CONST = 4.01094480918336, D_Xd1 = 1.1137756892884, D_Xd2 = -0.380925520464488, </span></a>
<a class="sourceLine" id="cb7-162" title="162"><span class="co">#&gt;     D_X1 = 2.44419761908979, D_X2 = 5.29620369779804, S_P = 1.70876661459514, </span></a>
<a class="sourceLine" id="cb7-163" title="163"><span class="co">#&gt;     S_CONST = 2.885697667298, S_Xs1 = 0.493421828653425, S_X1 = 1.70854379946901, </span></a>
<a class="sourceLine" id="cb7-164" title="164"><span class="co">#&gt;     S_X2 = 4.66113245104969, P_DIFF = 1, D_VARIANCE = 1, S_VARIANCE = 1, </span></a>
<a class="sourceLine" id="cb7-165" title="165"><span class="co">#&gt;     RHO = 0), minuslogl = function (...) </span></a>
<a class="sourceLine" id="cb7-166" title="166"><span class="co">#&gt;     minus_log_likelihood(object, ...), gr = function (...) </span></a>
<a class="sourceLine" id="cb7-167" title="167"><span class="co">#&gt;     gradient(object, ...)))</span></a>
<a class="sourceLine" id="cb7-168" title="168"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-169" title="169"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb7-170" title="170"><span class="co">#&gt;             Estimate Std. Error  z value  Pr(z)    </span></a>
<a class="sourceLine" id="cb7-171" title="171"><span class="co">#&gt; D_P        -1.849202   0.102147 -18.1034 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-172" title="172"><span class="co">#&gt; D_CONST     4.860420   0.082592  58.8486 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-173" title="173"><span class="co">#&gt; D_Xd1       2.054982   0.047717  43.0664 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-174" title="174"><span class="co">#&gt; D_Xd2      -0.675406   0.019519 -34.6019 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-175" title="175"><span class="co">#&gt; D_X1        3.501842   0.053401  65.5767 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-176" title="176"><span class="co">#&gt; D_X2        6.211275   0.046794 132.7369 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-177" title="177"><span class="co">#&gt; S_P         2.757014   0.030859  89.3424 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-178" title="178"><span class="co">#&gt; S_CONST     1.284230   0.081551  15.7476 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-179" title="179"><span class="co">#&gt; S_Xs1       0.640862   0.014799  43.3037 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-180" title="180"><span class="co">#&gt; S_X1        1.181013   0.020696  57.0636 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-181" title="181"><span class="co">#&gt; S_X2        4.200912   0.019469 215.7692 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-182" title="182"><span class="co">#&gt; P_DIFF     -0.013436   0.013574  -0.9898 0.3223    </span></a>
<a class="sourceLine" id="cb7-183" title="183"><span class="co">#&gt; D_VARIANCE  0.999927   0.023931  41.7841 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-184" title="184"><span class="co">#&gt; S_VARIANCE  0.994434   0.011789  84.3560 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-185" title="185"><span class="co">#&gt; RHO         0.511222   0.017821  28.6869 &lt;2e-16 ***</span></a>
<a class="sourceLine" id="cb7-186" title="186"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb7-187" title="187"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb7-188" title="188"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-189" title="189"><span class="co">#&gt; -2 log L: 46373.32</span></a></code></pre></div>
</div>
<div id="model-selection" class="section level3">
<h3>Model selection</h3>
<p>The deterministic adjustment model has price dynamics that are analogous to excess demand and estimates one extra parameter. The directional model estimates one parameter less as the model does not have enough equations to identify prices in both demand and supply equations. The estimated parameters are summarized as follows.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">sim_coef &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb8-2" title="2">  alpha_d, beta_d0, beta_d, eta_d,</a>
<a class="sourceLine" id="cb8-3" title="3">  alpha_s, beta_s0, beta_s, eta_s,</a>
<a class="sourceLine" id="cb8-4" title="4">  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb8-5" title="5">  sigma_d, sigma_s,</a>
<a class="sourceLine" id="cb8-6" title="6">  rho_ds</a>
<a class="sourceLine" id="cb8-7" title="7">)</a>
<a class="sourceLine" id="cb8-8" title="8"><span class="kw">names</span>(sim_coef) &lt;-<span class="st"> </span><span class="kw">names</span>(damdl_est<span class="op">@</span>coef)</a>
<a class="sourceLine" id="cb8-9" title="9"></a>
<a class="sourceLine" id="cb8-10" title="10">dm_inc &lt;-<span class="st"> </span>eq2sls<span class="op">@</span>system_model<span class="op">$</span>coefficients[</a>
<a class="sourceLine" id="cb8-11" title="11">  <span class="kw">grep</span>(</a>
<a class="sourceLine" id="cb8-12" title="12">    <span class="st">&quot;demand&quot;</span>,</a>
<a class="sourceLine" id="cb8-13" title="13">    <span class="kw">names</span>(eq2sls<span class="op">@</span>system_model<span class="op">$</span>coefficients)</a>
<a class="sourceLine" id="cb8-14" title="14">  )</a>
<a class="sourceLine" id="cb8-15" title="15">]</a>
<a class="sourceLine" id="cb8-16" title="16">sp_inc &lt;-<span class="st"> </span>eq2sls<span class="op">@</span>system_model<span class="op">$</span>coefficients[</a>
<a class="sourceLine" id="cb8-17" title="17">  <span class="kw">grep</span>(</a>
<a class="sourceLine" id="cb8-18" title="18">    <span class="st">&quot;supply&quot;</span>,</a>
<a class="sourceLine" id="cb8-19" title="19">    <span class="kw">names</span>(eq2sls<span class="op">@</span>system_model<span class="op">$</span>coefficients)</a>
<a class="sourceLine" id="cb8-20" title="20">  )</a>
<a class="sourceLine" id="cb8-21" title="21">]</a>
<a class="sourceLine" id="cb8-22" title="22">lm_coef &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb8-23" title="23">  dm_inc[<span class="dv">2</span>], dm_inc[<span class="op">-</span><span class="dv">2</span>], sp_inc[<span class="dv">2</span>], sp_inc[<span class="op">-</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb8-24" title="24">  <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb8-25" title="25">  <span class="ot">NA</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb8-26" title="26">  <span class="ot">NA</span></a>
<a class="sourceLine" id="cb8-27" title="27">)</a>
<a class="sourceLine" id="cb8-28" title="28"></a>
<a class="sourceLine" id="cb8-29" title="29">eqfiml_coef &lt;-<span class="st"> </span><span class="kw">append</span>(</a>
<a class="sourceLine" id="cb8-30" title="30">  eqfiml_est<span class="op">@</span>coef, <span class="kw">c</span>(<span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb8-31" title="31">  <span class="dt">after =</span> <span class="kw">which</span>(<span class="kw">names</span>(eqfiml_est<span class="op">@</span>coef) <span class="op">==</span></a>
<a class="sourceLine" id="cb8-32" title="32"><span class="st">    </span><span class="kw">get_prefixed_variance_variable</span>(eqfiml<span class="op">@</span>system<span class="op">@</span>demand)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb8-33" title="33">)</a>
<a class="sourceLine" id="cb8-34" title="34"></a>
<a class="sourceLine" id="cb8-35" title="35">bsmdl_coef &lt;-<span class="st"> </span><span class="kw">append</span>(</a>
<a class="sourceLine" id="cb8-36" title="36">  bsmdl_est<span class="op">@</span>coef, <span class="kw">c</span>(<span class="ot">NA</span>),</a>
<a class="sourceLine" id="cb8-37" title="37">  <span class="dt">after =</span> <span class="kw">which</span>(<span class="kw">names</span>(bsmdl_est<span class="op">@</span>coef) <span class="op">==</span></a>
<a class="sourceLine" id="cb8-38" title="38"><span class="st">    </span><span class="kw">get_prefixed_variance_variable</span>(bsmdl<span class="op">@</span>system<span class="op">@</span>demand)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb8-39" title="39">)</a>
<a class="sourceLine" id="cb8-40" title="40"></a>
<a class="sourceLine" id="cb8-41" title="41">damdl_coef &lt;-<span class="st"> </span>damdl_est<span class="op">@</span>coef</a>
<a class="sourceLine" id="cb8-42" title="42"></a>
<a class="sourceLine" id="cb8-43" title="43">comp &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb8-44" title="44">  <span class="dt">parameter =</span> <span class="kw">names</span>(sim_coef),</a>
<a class="sourceLine" id="cb8-45" title="45">  <span class="dt">sim =</span> sim_coef, <span class="dt">lm =</span> lm_coef, <span class="dt">fi =</span> eqfiml_coef,</a>
<a class="sourceLine" id="cb8-46" title="46">  <span class="dt">bm =</span> bsmdl_coef, <span class="dt">da =</span> damdl_coef,</a>
<a class="sourceLine" id="cb8-47" title="47">  <span class="dt">lmerr =</span> <span class="kw">abs</span>(lm_coef <span class="op">-</span><span class="st"> </span>sim_coef), <span class="dt">fierr =</span> <span class="kw">abs</span>(eqfiml_coef <span class="op">-</span><span class="st"> </span>sim_coef),</a>
<a class="sourceLine" id="cb8-48" title="48">  <span class="dt">bmerr =</span> <span class="kw">abs</span>(bsmdl_coef <span class="op">-</span><span class="st"> </span>sim_coef), <span class="dt">daerr =</span> <span class="kw">abs</span>(damdl_coef <span class="op">-</span><span class="st"> </span>sim_coef)</a>
<a class="sourceLine" id="cb8-49" title="49">)</a>
<a class="sourceLine" id="cb8-50" title="50">comp</a>
<a class="sourceLine" id="cb8-51" title="51"><span class="co">#&gt; # A tibble: 15 x 10</span></a>
<a class="sourceLine" id="cb8-52" title="52"><span class="co">#&gt;    parameter   sim     lm     fi      bm      da    lmerr    fierr  bmerr</span></a>
<a class="sourceLine" id="cb8-53" title="53"><span class="co">#&gt;    &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb8-54" title="54"><span class="co">#&gt;  1 D_P       -1.9  -1.84  -1.85   0.0498 -1.85    5.58e-2  0.0524   1.95 </span></a>
<a class="sourceLine" id="cb8-55" title="55"><span class="co">#&gt;  2 D_CONST    4.9   4.88   4.85   4.01    4.86    2.38e-2  0.0544   0.885</span></a>
<a class="sourceLine" id="cb8-56" title="56"><span class="co">#&gt;  3 D_Xd1      2.1   2.05   2.06   1.32    2.05    4.76e-2  0.0429   0.778</span></a>
<a class="sourceLine" id="cb8-57" title="57"><span class="co">#&gt;  4 D_Xd2     -0.7  -0.686 -0.676 -0.455  -0.675   1.42e-2  0.0239   0.245</span></a>
<a class="sourceLine" id="cb8-58" title="58"><span class="co">#&gt;  5 D_X1       3.5   3.50   3.50   2.58    3.50    2.50e-3  0.00361  0.922</span></a>
<a class="sourceLine" id="cb8-59" title="59"><span class="co">#&gt;  6 D_X2       6.25  6.21   6.21   5.39    6.21    3.83e-2  0.0368   0.860</span></a>
<a class="sourceLine" id="cb8-60" title="60"><span class="co">#&gt;  7 S_P        2.8   2.75   2.75   1.76    2.76    4.90e-2  0.0495   1.04 </span></a>
<a class="sourceLine" id="cb8-61" title="61"><span class="co">#&gt;  8 S_CONST    1.2   1.31   1.31   2.84    1.28    1.10e-1  0.112    1.64 </span></a>
<a class="sourceLine" id="cb8-62" title="62"><span class="co">#&gt;  9 S_Xs1      0.65  0.641  0.641  1.12    0.641   9.09e-3  0.00914  0.469</span></a>
<a class="sourceLine" id="cb8-63" title="63"><span class="co">#&gt; 10 S_X1       1.15  1.18   1.18   1.58    1.18    3.08e-2  0.0306   0.425</span></a>
<a class="sourceLine" id="cb8-64" title="64"><span class="co">#&gt; 11 S_X2       4.2   4.20   4.20   4.61    4.20    8.26e-4  0.00108  0.414</span></a>
<a class="sourceLine" id="cb8-65" title="65"><span class="co">#&gt; 12 P_DIFF    NA    NA     NA     NA      -0.0134 NA       NA       NA    </span></a>
<a class="sourceLine" id="cb8-66" title="66"><span class="co">#&gt; 13 D_VARIAN…  1    NA      1.00   0.822   1.00   NA        0.00117  0.178</span></a>
<a class="sourceLine" id="cb8-67" title="67"><span class="co">#&gt; 14 S_VARIAN…  1    NA      0.994  1.37    0.994  NA        0.00556  0.372</span></a>
<a class="sourceLine" id="cb8-68" title="68"><span class="co">#&gt; 15 RHO        0.5  NA      0.510  0.205   0.511  NA        0.0104   0.295</span></a>
<a class="sourceLine" id="cb8-69" title="69"><span class="co">#&gt; # … with 1 more variable: daerr &lt;dbl&gt;</span></a></code></pre></div>
<p>Since we have used simulated data, we can calculate the average absolute error of the parameter estimation for each of the models. In practice, the population values are unknown and this calculation is impossible.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">comp_means &lt;-<span class="st"> </span><span class="kw">colMeans</span>(comp[, <span class="kw">grep</span>(<span class="st">&quot;err&quot;</span>, <span class="kw">colnames</span>(comp))], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">comp_means</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">#&gt;      lmerr      fierr      bmerr      daerr </span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; 0.03467257 0.03092702 0.74766291 0.02754986</span></a></code></pre></div>
<p>Moreover, the average absolute error cannot provide an overall estimation assessment as the market models have different parameter spaces. To assess the overall model performance one can instead use an information criterion.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">model_names &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb10-2" title="2">  eqfiml<span class="op">@</span>model_type_string,</a>
<a class="sourceLine" id="cb10-3" title="3">  bsmdl<span class="op">@</span>model_type_string, damdl<span class="op">@</span>model_type_string</a>
<a class="sourceLine" id="cb10-4" title="4">)</a>
<a class="sourceLine" id="cb10-5" title="5">model_obs &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb10-6" title="6">  <span class="kw">get_number_of_observations</span>(eqfiml),</a>
<a class="sourceLine" id="cb10-7" title="7">  <span class="kw">get_number_of_observations</span>(bsmdl),</a>
<a class="sourceLine" id="cb10-8" title="8">  <span class="kw">get_number_of_observations</span>(damdl)</a>
<a class="sourceLine" id="cb10-9" title="9">)</a>
<a class="sourceLine" id="cb10-10" title="10">model_errors &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb10-11" title="11">  comp_means[<span class="st">&quot;fierr&quot;</span>],</a>
<a class="sourceLine" id="cb10-12" title="12">  comp_means[<span class="st">&quot;bmerr&quot;</span>],</a>
<a class="sourceLine" id="cb10-13" title="13">  comp_means[<span class="st">&quot;daerr&quot;</span>]</a>
<a class="sourceLine" id="cb10-14" title="14">)</a>
<a class="sourceLine" id="cb10-15" title="15">seltbl &lt;-<span class="st"> </span><span class="kw">AIC</span>(eqfiml_est, bsmdl_est, damdl_est) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-16" title="16"><span class="st">  </span>tibble<span class="op">::</span><span class="kw">add_column</span>(<span class="dt">Model =</span> model_names, <span class="dt">.before =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="st">  </span>tibble<span class="op">::</span><span class="kw">add_column</span>(<span class="dt">Obs. =</span> model_obs, <span class="st">`</span><span class="dt">Mean Error</span><span class="st">`</span> =<span class="st"> </span>model_errors) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">rename</span>(<span class="dt">D.F. =</span> df) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-19" title="19"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(AIC)</a>
<a class="sourceLine" id="cb10-20" title="20">seltbl</a>
<a class="sourceLine" id="cb10-21" title="21"><span class="co">#&gt;                      Model D.F.      AIC  Obs. Mean Error</span></a>
<a class="sourceLine" id="cb10-22" title="22"><span class="co">#&gt; 1         Equilibrium FIML   14 46402.23 20000 0.03092702</span></a>
<a class="sourceLine" id="cb10-23" title="23"><span class="co">#&gt; 2 Deterministic Adjustment   15 46403.32 20000 0.02754986</span></a>
<a class="sourceLine" id="cb10-24" title="24"><span class="co">#&gt; 3                    Basic   14 51273.47 20000 0.74766291</span></a></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
